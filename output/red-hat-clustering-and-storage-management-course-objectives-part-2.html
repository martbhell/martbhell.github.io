<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Red Hat – Clustering and Storage Management – Course Objectives - part 2 | There is IT in Helsinki
</title>
  <link rel="canonical" href="/red-hat-clustering-and-storage-management-course-objectives-part-2.html">


  <link rel="stylesheet" href="/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="/theme/css/theme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="/atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="/it.atom.xml">  
  <meta name="description" content="Post 1 - https://www.guldmyr.com/red-hat-clustering-and-storage-management-course-objectives/ Where I checked out udev, multipathing, iscsi, LVM and xfs. This post is about getting using luci/ricci to get a Red Hat cluster working, but not on a RHEL machine because sadly I do not have one available for practice purposes. So …">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="/">
        <img class="img-fluid rounded" src=/images/blog_site_image.png alt="There is IT in Helsinki">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="/">There is IT in Helsinki</a></h1>
      <ul class="list-inline">
          <li class="list-inline-item"><a href="/tags/" target="_blank">tags</a></li>
          <li class="list-inline-item"><a href="/categories/" target="_blank">categories</a></li>
            <li class=" list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/martbhell" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fas fa-rss" href="/atom.xml" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/martbhell" target="_blank"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Red Hat – Clustering and Storage Management – Course Objectives - part 2
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2013-08-21T00:00:00+03:00">
          <i class="fas fa-clock"></i>
          2013-08-21
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="/category/it.html">it</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="/tag/certification.html">#certification</a>,               <a href="/tag/cluster.html">#cluster</a>,               <a href="/tag/iscsi.html">#iscsi</a>,               <a href="/tag/linux.html">#linux</a>,               <a href="/tag/lvm.html">#lvm</a>,               <a href="/tag/openstack.html">#openstack</a>,               <a href="/tag/red.html">#red</a>,               <a href="/tag/hat.html">#hat</a>,               <a href="/tag/rhce.html">#rhce</a>,               <a href="/tag/storage.html">#storage</a>          </li>
      </ul>
    </header>
    <div class="content">
      <p>Post 1 - <a href="https://www.guldmyr.com/red-hat-clustering-and-storage-management-course-objectives/">https://www.guldmyr.com/red-hat-clustering-and-storage-management-course-objectives/</a> Where I checked out udev, multipathing, iscsi, LVM and xfs.</p>
<p><strong>This</strong> post is about getting using luci/ricci to get a Red Hat cluster working, but not on a RHEL machine because sadly I do not have one available for practice purposes. So CentOS64 it is. Using openstack for virtualization.</p>
<p>Topology: Four hosts on all three networks, -a, -b and internal. Three cluster nodes and one management node.</p>
<p>Get the basic cluster going:</p>
<ul>
<li>image four identical nodes</li>
<li>ssh-key is distributed</li>
<li>/etc/hosts file has all hosts, IPs and networks<ul>
<li>network interfaces are configured -</li>
<li>set a gateway in /etc/sysconfig/network</li>
</ul>
</li>
<li>firewall<ul>
<li>all traffic allowed from -a and -b networks</li>
<li>at a minimum allow traffic from the network that the hostname corresponds to that you enter in luci</li>
</ul>
</li>
<li>dns (PEERDNS=no is good with several dhcp interfaces)</li>
<li>timesync with ntpd</li>
<li>luci installed on mgmt-node # ricci is a web gui</li>
<li>ricci installed on all cluster nodes # this is the service talks with corosync<ul>
<li>password set for user ricci on cluster nodes</li>
</ul>
</li>
<li>create cluster in luci<ul>
<li>multicast perhaps doesn't work so well in openstack ?</li>
<li>on cluster nodes this runs "yum -y install cman rgmanager lvm2-cluster sg3_utils gfs2-utils" if shared storage is selected, probably less if not.</li>
</ul>
</li>
<li>fencing is really important, how to do it in openstack would require a bit of work though. Not as easy as with kvm/xvm to send a destroy domain message.</li>
</ul>
<p>Tests:</p>
<ul>
<li>Update and distribute cluster.conf</li>
<li>Have a service run on a node on the cluster (doesn't have to have a shared storage for this).</li>
<li>Commands:<ul>
<li>clustat</li>
<li>cman_tool</li>
<li>rg_test test /etc/cluster/cluster.conf start service name-of-service</li>
<li>ccs_config_validate</li>
</ul>
</li>
</ul>
<p>Share an iSCSI target between all nodes:</p>
<ul>
<li>Using management node to share the iSCSI LUN.</li>
<li>tgtd, multipath</li>
<li>clvmd running on all nodes</li>
<li>lvmconf - make sure locking is set correctly</li>
<li>create vg with clustering</li>
<li>partprobe; multipath -r # do this often</li>
<li>vgs/lvs and make sure all nodes see the clusterd lv</li>
<li>minimum GFS filesystem is around 128M - you didn't use all the vg right? =)<ul>
<li>for testing/small cluster lowering the journal size is goodness</li>
</ul>
</li>
<li>mount!</li>
</ul>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
    <li class="list-inline-item"><a href="https://wtangy.se">Was There an NHL Game Yesterday?</a></li>
    <li class="list-inline-item"><a href="/tag/resepti">Recipes in Finnish</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>