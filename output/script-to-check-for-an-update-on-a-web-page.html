<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>"Script To Check For an Update on a Web Page"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content=""it" tags: "bash" "bash-scripting" "linux" "script" "scripting" "spotify" "wget" Hey! This is used for me on my Linux workstation to get a..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">There is IT in Helsinki</a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/script-to-check-for-an-update-on-a-web-page.html" rel="bookmark"
           title="Permalink to "Script To Check For an Update on a Web Page"">"Script To Check For an Update on a Web Page"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-10-19T00:00:00+03:00">
                Published: "2011-10-19"
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/johan-guldmyr.html">Johan Guldmyr</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->      <ul>
<li>"it"
tags: </li>
<li>"bash"</li>
<li>"bash-scripting"</li>
<li>"linux"</li>
<li>"script"</li>
<li>"scripting"</li>
<li>"spotify"</li>
<li>"wget"</li>
</ul>
<hr>
<p>Hey!</p>
<p>This is used for me on my Linux workstation to get a notification if there is a new spotify release whenever I open a new terminal.. It would be applicable for other (probably also simple) pages that aren't updated frequently.</p>
<p>Reason: <a href="http://repository.spotify.com/pool/non-free/s/spotify/">http://repository.spotify.com/pool/non-free/s/spotify/</a></p>
<p>I wanted to see if there was a new spotify release for Linux/QT.</p>
<p>Method: The URL is above - but what if I do not want to go there every day and get disappointed?</p>
<p>Way nicer to have a script do it for me.</p>
<p>This script saves the index.html from the URL above of each day.</p>
<p>Then each day when it downloads the .html it checks if it's different from yesterday.</p>
<p>This has its limitations, if there is an update in the weekend I will never know.</p>
<p>The script should check the last x amount of days and if any of them are different from today it should tell me. The script checks if any of the files are different from today, if so, it will write something into another file. The script then checks if this file is non-empty, if it has data in it, it will write to this other file that. Tada. :p</p>
<p>If it is, then it will write to a file that is referenced in $HOME/.bashrc.</p>
<p>The layout of the blog doesn't like really long lines in <pre>, but you can select below and only get the post (and not the stuff on the right side).</p>
<p>spot_check.sh:</p>
<h1>!/bin/sh</h1>
<p>dat1=$(date +%Y.%m.%d)
daty=$(perl -MPOSIX=strftime -le 'print strftime "%Y.%m.%d",localtime (time - 86400)')
dat2=$(perl -MPOSIX=strftime -le 'print strftime "%Y.%m.%d",localtime (time - 172800)')
dat3=$(perl -MPOSIX=strftime -le 'print strftime "%Y.%m.%d",localtime (time - 259200)')
dat4=$(perl -MPOSIX=strftime -le 'print strftime "%Y.%m.%d",localtime (time - 345600)')
dat5=$(perl -MPOSIX=strftime -le 'print strftime "%Y.%m.%d",localtime (time - 432000)')</p>
<p>path="$HOME/Downloads/Spotify/saved"
out="$HOME/Downloads/Spotify/diff.log"
bout="$HOME/.spotcheck"
wget -q http://repository.spotify.com/pool/non-free/s/spotify/ -O $path/$dat1.html</p>
<p>diff -q $path/$dat1.html $path/$daty.html &gt; $out
diff -q $path/$dat1.html $path/$dat2.html &gt;&gt; $out
diff -q $path/$dat1.html $path/$dat3.html &gt;&gt; $out
diff -q $path/$dat1.html $path/$dat4.html &gt;&gt; $out
diff -q $path/$dat1.html $path/$dat5.html &gt;&gt; $out</p>
<p>if [[ -s $out ]] ; then
echo $out "is not empty";
echo "#!/bin/sh" &gt; $bout;
echo "echo new spotify release" &gt;&gt; $bout;
chmod +x $bout;
else
echo $out "is empty";
echo "No new spotify release.";
rm $bout;
fi;</p>
<p>Crontab (daily at 0915):</p>
<p>15 09 * * * /bin/bash /home/username/Downloads/Spotify/spot_check.sh 2&gt;&amp;1</p>
<p>.bashrc:</p>
<p>if [ -f ~/.spotcheck ]; then
cd $HOME
./.spotcheck
fi</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>