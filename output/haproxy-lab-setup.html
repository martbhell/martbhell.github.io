<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  haproxy lab setup! | There is IT in Helsinki
</title>
  <link rel="canonical" href="/haproxy-lab-setup.html">


  <link rel="stylesheet" href="/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="/theme/css/theme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="/atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="/it.atom.xml">  
  <meta name="description" content="Been seeing haproxy more and more lately as it seems even the stuff I work with are moving towards web :) So a good time as any to play around with it! First setup is the tag "single-node" in https://github.com/martbhell/haproxy-lab - this means it just configures one apache …">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="/">
        <img class="img-fluid rounded" src=/images/blog_site_image_small.webp alt="There is IT in Helsinki">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="/">There is IT in Helsinki</a></h1>
      <ul class="list-inline">
          <li class="list-inline-item"><a href="/tags/" target="_blank">tags</a></li>
          <li class="list-inline-item"><a href="/categories/" target="_blank">categories</a></li>
            <li class=" list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/martbhell" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fas fa-rss" href="/atom.xml" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/martbhell" target="_blank"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  haproxy lab setup!
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2017-08-07T00:00:00+03:00">
          <i class="fas fa-clock"></i>
          2017-08-07
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="/category/it.html">it</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="/tag/ansible.html">#ansible</a>,               <a href="/tag/haproxy.html">#haproxy</a>,               <a href="/tag/openstack.html">#openstack</a>          </li>
      </ul>
    </header>
    <div class="content">
      <p>Been seeing haproxy more and more lately as it seems even the stuff I work with are moving towards web :)</p>
<p>So a good time as any to play around with it!</p>
<p>First setup is the tag "single-node" in <a href="https://github.com/martbhell/haproxy-lab">https://github.com/martbhell/haproxy-lab</a> - this means it just configures one apache httpd and one haproxy. In the haproxy it creates multiple vhosts with content being served from different directories, and then it points to each of these as a haproxy backend.</p>
<p>To illustrate the load balancing the playbook also installs php and shows the path of the file that's being served.</p>
<p>I used ansible for this and only tested it with CentOS7 in an OpenStack. The playbook also sets up some "dns" in /etc/hosts.</p>
<p>There are also "ops_playbooks" for disabling/enabling backends and setting weights.</p>
<p>I wonder what's a good next step. Maybe multiple hosts / Docker containers? Maybe SSL termination + letsencrypt? Maybe some <a href="https://medium.freecodecamp.org/how-we-fine-tuned-haproxy-to-achieve-2-000-000-concurrent-ssl-connections-d017e61a4d27">performance benchmarking/tuning</a>? I like the help for the <a href="http://www.haproxy.org/download/1.5/doc/configuration.txt">configuration file</a> - it begins with some detail about what an HTTP request looks like :)</p>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
    <li class="list-inline-item"><a href="https://wtangy.se">Was There an NHL Game Yesterday?</a></li>
    <li class="list-inline-item"><a href="/tag/resepti">Recipes in Finnish</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>