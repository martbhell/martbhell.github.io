<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  BCFP - Fibre Channel Routing - FCR - FC-FC Routing | There is IT in Helsinki
</title>
  <link rel="canonical" href="/bcfp-fibre-channel-routing-fcr-fc-fc-routing.html">


  <link rel="stylesheet" href="/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="/theme/css/theme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="/atom.xml">
  
  <meta name="description" content="FCR; Fibre Channel Routing; FC-FC Routing; etc; etc. This has many names. FC-FC Routing service provides FCR (fibre channel routing). Basically what it does is that it lets you zone devices in two separate fabrics without merging them. These two separate fabrics are called 'edge fabrics' in Brocade lingo, they …">
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o);
      a.async = 1;
      a.src = g;
      m = s.getElementsByTagName(o)[0];
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'G-H4LG7R6ZGG', 'auto');
    ga('send', 'pageview');
  </script>


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="/">
        <img class="img-fluid rounded" src=/images/blog_site_image.png alt="There is IT in Helsinki">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="/">There is IT in Helsinki</a></h1>
      <ul class="list-inline">
          <li class="list-inline-item"><a href="/tags/" target="_blank">tags</a></li>
          <li class="list-inline-item"><a href="/categories/" target="_blank">categories</a></li>
            <li class=" list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/martbhell" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fas fa-rss" href="/atom.xml" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/martbhell" target="_blank"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  BCFP - Fibre Channel Routing - FCR - FC-FC Routing
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2011-07-26T00:00:00+03:00">
          <i class="fas fa-clock"></i>
          2011-07-26
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="/category/storage.html">storage</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="/tag/bcfp.html">#bcfp</a>,               <a href="/tag/brocade.html">#brocade</a>,               <a href="/tag/certified.html">#certified</a>,               <a href="/tag/fabric.html">#fabric</a>,               <a href="/tag/professional.html">#professional</a>,               <a href="/tag/fc.html">#fc</a>,               <a href="/tag/routing.html">#routing</a>,               <a href="/tag/fcr.html">#fcr</a>,               <a href="/tag/fibre.html">#fibre</a>,               <a href="/tag/channel.html">#channel</a>,               <a href="/tag/san.html">#san</a>,               <a href="/tag/network.html">#network</a>,               <a href="/tag/storage.html">#storage</a>          </li>
      </ul>
    </header>
    <div class="content">
      <p>FCR; Fibre Channel Routing; FC-FC Routing; etc; etc.</p>
<p>This has many names. FC-FC Routing service provides FCR (fibre channel routing). Basically what it does is that it lets you zone devices in two separate fabrics without merging them. These two separate fabrics are called 'edge fabrics' in Brocade lingo, they are otherwise known as SAN islands. The edge fabric is connected to a backbone fabric (an FC router or at least an EX_Port).</p>
<p>Integrated Routing - is a licensed feature that lets you run FCR on a port that is in a normal port in a normal switch or port blade (so not in a dedicated router switch or router blade).</p>
<h2 id="theres-a-few-things-required-to-set-up-fcr">There's a few things required to set up FCR:</h2>
<ol>
<li>Verify that you have the proper setup (required licenses/hardware)</li>
<li>Assign backbone FIDs (<strong>switchdisable; fosConfig --disable fcr; fcrconfigure; fosconfig --enable; switchenable</strong>)</li>
<li>Configure FCIP tunnel (not required but: <strong>portcfg fciptunnel 8/ge0 create 2 1.1.1.1 1.1.2.1 0 -v 100 -p 3 -P 7</strong> . Remote IP first, tunnel ID, vlan, Classes for layer2 control and data traffic)</li>
<li>Configure IFLs - inter fabric links - links between edge and backbone fabrics (portcfgvexport, <strong>portcfgexport 7 -a 1 -f 30</strong> . port 7, enable, fabric id 30)</li>
<li>Modify cost on the EX_ports (not required; <strong>portdisable; portcfgexport 7 -a 1; fcrrouterportcost 7 10000</strong>; for default, set it to 0; <strong>fcrRouteShow</strong> also shows cost)</li>
<li>Connect cables (if you do it before and they are configured as E_port you may get segmentation).</li>
<li>Configure trunking on EX_ports (not required but if you have more than one link, please do, same commands as for E_port trunking)</li>
<li>Configure LSAN zones (same as normal zoning; <strong>zonecreate "lsan_zone_fabric", "wwn; wwn2; wwn3"; cfgadd "zone_cfg", "lsan_zone_fabric"; cfgenable "zone_cfg"</strong>). Use <strong>lsanzoneshow -s</strong>. Shows imported/exist/configured/initializing. <strong>fcrphydevshow, fcrproxydevshow</strong> are also useful.</li>
<li>Confirm that it's working (<strong>fcrfabricshow, switchshow, portcfgshow, portexport 7, portshow 7</strong>)</li>
</ol>
<p>So what you have to do is: assign FIDs, configure IFLs and LSAN zones. </p>
<h2 id="a-little-theory">A little theory</h2>
<p>Phantom domains.</p>
<p><strong>Front domains</strong> -&gt; always there</p>
<p><strong>Translate domains</strong> (also xlate domains...).  -&gt; only there when devices are online and zoned</p>
<p>The FC router has a pool of wwns and proxy ids that it assigns to devices. Basically a host that wants to communicate with a target in another fabric communicates with a proxy WWN in its own fabric (so the FC router is like a middle man that passes frames back n forth).</p>
<h2 id="a-little-more-information">A little more information</h2>
<p>When a PLOGI, PDISC, ADISC frame arrives at the FC router, SID and DID are checked. If they are zoned in both SID and DID edge fabrics (islands), the frame is forwarded to DID. If not, only PLOGI is dropped; edge fabrics' zoning enforcement takes care of the rest.</p>
<p>I found <a href="http://education.emc.com/main/common/documents/ks_articles/brocade_fibre_channel_routing.pdf" title="on emc.com and it's a pdf">this document</a> on EMC's webpage (it's from 2007 so a bit outdated and it has EMC's names of the Brocade products) but it explains the concept pretty nicely.</p>
<p>Also, this post is for me to study for the BCFP, I find that I learn better when I write things down with a keyboard ;) There may be mistakes in here but that's just how it is, I tried to keep it as factual as possible and used several sources. There will most likely be more of these posts coming up.</p>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
    <li class="list-inline-item"><a href="https://wtangy.se">Was There an NHL Game Yesterday?</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>