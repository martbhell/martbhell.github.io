<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>There is IT in Helsinki - imap</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="There is IT in Helsinki Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">There is IT in Helsinki</a></h1>
                <nav><ul>
                    <li><a href="/category/finland.html">finland</a></li>
                    <li><a href="/category/it.html">it</a></li>
                    <li><a href="/category/storage.html">storage</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/red-hat-certification-rhce-network-services-e-mail.html">"Red Hat Certification – RHCE – Network Services – e-mail"</a></h1>
<footer class="post-info">
        <abbr class="published" title="2012-06-04T00:00:00+03:00">
                Published: "2012-06-04"
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/johan-guldmyr.html">Johan Guldmyr</a>
        </address>
<p>In <a href="/category/it.html">it</a>.</p>
<p>tags: <a href="/tag/centos.html">centos</a> <a href="/tag/certification.html">certification</a> <a href="/tag/dovecot.html">dovecot</a> <a href="/tag/file.html">file</a> <a href="/tag/transfer.html">transfer</a> <a href="/tag/imap.html">imap</a> <a href="/tag/linux.html">linux</a> <a href="/tag/postfix.html">postfix</a> <a href="/tag/red.html">red</a> <a href="/tag/hat.html">hat</a> <a href="/tag/rhce.html">rhce</a> <a href="/tag/sendmail.html">sendmail</a> <a href="/tag/smtp.html">smtp</a> <a href="/tag/studying.html">studying</a> </p>
</footer><!-- /.post-info --><p><a href="http://www.guldmyr.com/blog/red-hat-certification-rhce-system-configuration-and-management-2/" title="1st post">1st post</a> - System Management and Configuration</p>
<p><a href="https://www.redhat.com/training/courses/ex300/examobjective" title="on redhat.com">Objectives</a></p>
<h1>Network services</h1>
<p>Network services are an important subset of the exam objectives. RHCE candidates should be capable of meeting the following objectives for each of the network services listed below:</p>
<ul>
<li>Install the packages needed to provide the service.</li>
<li>Configure SELinux to support the service.</li>
<li>Configure the service to start when the system is booted.</li>
<li>Configure the service for basic operation.</li>
<li>Configure host-based and user-based security for the service.</li>
</ul>
<p>User should be able to do the following for all these services:</p>
<ul>
<li><a href="http://guldmyr.com/blog/red-hat-certification-rhce-network-services-httpd">http/https</a></li>
<li><a href="http://guldmyr.com/blog/red-hat-certification-rhce-network-services-dns">dns</a></li>
<li><a href="http://www.guldmyr.com/blog/red-hat-certification-rhce-network-services-ftp">ftp</a></li>
<li><a href="http://www.guldmyr.com/blog/red-hat-certification-rhce-network-services-nfs/">nfs</a></li>
<li><a href="http://www.guldmyr.com/blog/red-hat-certification-rhce-network-services-smb/">smb</a></li>
<li><a href="http://www.guldmyr.com/blog/red-hat-certification-rhce-network-services-e-mail/">smtp</a></li>
<li>ssh</li>
<li>ntp</li>
</ul>
<h2>SMTP:</h2>
<p>Hackmode has a <a href="http://www.hackmode.net/?page_id=80" title="on hackmode.net">good article</a> about setting postfix for the first time.</p>
<p>To test that e-mail is working you can - tada - use an e-mail client.</p>
<p>You have lots of details in /usr/share/doc/postfix-N ( the path should be in /etc/postfix/main.cf )</p>
<ul>
<li>
<p>Install the packages needed to provide the service.</p>
</li>
<li>
<p>yum install postfix</p>
</li>
<li>
<p>Configure SELinux to support the service</p>
</li>
<li>
<p>getsebool -a|grep postfix</p>
</li>
<li>
<p>Configure the service to start when the system is booted.</p>
</li>
<li>
<p>chkconfig postfix on</p>
</li>
<li>
<p>Configure the service for basic operation.</p>
</li>
<li>
<p>set hostname to host.example.com</p>
</li>
<li>
<p>/etc/postfix/main.cf and define (this assumes hostname is host.example.com):</p>
</li>
<li>
<p>myhostname = host.example.com</p>
</li>
<li>mydomain = example.com</li>
<li>myorigin = $mydomain</li>
<li>inet_interfaces = all</li>
<li>mydestination = add $mydomain to the default one</li>
<li>home_mailbox = Maildir/</li>
<li>Update firewall to allow port 25 tcp</li>
<li>
<p>Test with: nc localhost 25</p>
</li>
<li>
<p>Configure host-based and user-based security for the service</p>
</li>
<li>
<p>iptables or $mynetworks in main.cf</p>
</li>
<li>user: postmap</li>
</ul>
<p>In CLI (important to use ' and not "):</p>
<h1>hostname - record the output of this</h1>
<p>postconf -e 'myhostname = output from hostname in here'</p>
<h1>hostname -d</h1>
<p>postconf -e 'mydomain = output from hostname -d in here'
postconf -e 'myorigin = $mydomain'
postconf -e 'inet_interface = all'
postconf -e 'mydestination = $myhostname, localhost, $mydomain'
postconf -e 'mynetworks = 127.0.0.0/8 [::1]/128, /32'
postconf -e 'relay_domains = $mydestination'
postconf -e 'home_mailbox = Maildir/'</p>
<p>To use it:</p>
<p>useradd -s /sbin/nologin labber
passwd labber</p>
<p>Edit /etc/aliases and add:</p>
<p>labber: labber</p>
<p>Then run:</p>
<p>newaliases
service postfix start
service postfix status
netstat -nlp|grep master</p>
<p>Send e-mail:</p>
<p>mail -s "Test e-mail here" labber@mydomain
test123
.</p>
<p>The . at the end is quite nice, that stops the input.</p>
<p>Check e-mail:</p>
<p>cat /home/labber/Maildir/new/*</p>
<h2>Real E-mail Client</h2>
<p>But, perhaps you want to check this out with a real e-mail client like thunderbird 10.</p>
<p>For this there needs to be a e-mail server that stores the e-mails on the server.</p>
<p>For this we can use 'dovecot'</p>
<p>yum install dovecot
service dovecot start</p>
<ol>
<li>Update iptables to allow ports 25 and 143 (TCP)</li>
<li>Update main.cf to allow from your IP</li>
<li>Restart services</li>
<li>
<p>Add new account in thunderbird -</p>
</li>
<li>
<p>do use the IP address of your server, not the DNS</p>
</li>
<li>do not use SMTP security (or username), but use password authentication</li>
<li>do use IMAP STARTTLS security, username: labber, password auth</li>
</ol>
<p>Thunderbird is quite nice, it will often tell you which setting is wrong.</p>
<p>You can use /var/log/maillog for details on the server-side (to see if you get connections at all for example).</p>
<h2>Deny a User</h2>
<p>To illustrate this feature we first need to add a second user/e-mail account:</p>
<p>useradd -s /sbin/nologin labrat
passwd labrat
echo "labrat: labrat" &gt;&gt; /etc/aliases
newaliases
service postfix restart
service dovecot restart
mail -s "test" labrat@mydomain</p>
<p>You need to send an e-mail to the e-mail address before you can add it in Thunderbird (because the user does not have a $HOME/Maildir until you do).</p>
<p>After the new user has been created and added to your e-mail client do <a href="http://www.cyberciti.biz/faq/howto-blacklist-reject-sender-email-address/" title="source">the following</a>:</p>
<p>cd /etc/postfix
echo "labber@mydomain REJECT" &gt;&gt; sender_access
postmap hash:sender_access
echo "smtpd_sender_restrictions = check_sender_access hash:/etc/postfix/sender_access" &gt;&gt; /etc/postfix/main.cf
service postfix restart</p>
<p>Try:</p>
<ul>
<li>to send an e-mail from and to both accounts</li>
</ul>
<h2>Extra</h2>
<ul>
<li>
<p>Configure a mail transfer agent (MTA) to accept inbound email from other systems.</p>
</li>
<li>
<p>inet_interfaces = all</p>
</li>
<li>
<p>Configure an MTA to forward (<a href="http://www.postfix.org/postconf.5.html#relayhost" title="on postfix.org">relay</a>) email through a smart host.</p>
</li>
<li>
<p>relayhost=hostname.domain.com</p>
</li>
</ul>
<p>If I understand this correctly to setup the above two we would need to have two servers.</p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://wtangy.se">Was There an NHL Game Yesterday?</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/martbhell">martbhell</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'G-H4LG7R6ZGG', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>